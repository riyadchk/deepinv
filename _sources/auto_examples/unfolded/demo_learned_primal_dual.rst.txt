
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/unfolded/demo_learned_primal_dual.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_unfolded_demo_learned_primal_dual.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_unfolded_demo_learned_primal_dual.py:


Learned Primal-Dual algorithm for CT scan.
====================================================================================================
Implementation of the Unfolded Primal-Dual algorithm from 

Adler, Jonas, and Ozan Öktem. 
"Learned primal-dual reconstruction." 
IEEE transactions on medical imaging 37.6 (2018): 1322-1332.

where both the data fidelity and the prior are learned modules, distinct for each iterations.

The algorithm is used for CT reconstruction trained on random phantoms. 
The phantoms are generated on the fly during training using the odl library (https://odlgroup.github.io/odl/).

.. GENERATED FROM PYTHON SOURCE LINES 15-28

.. code-block:: Python


    import deepinv as dinv
    from pathlib import Path
    import torch
    from torch.utils.data import DataLoader
    from deepinv.unfolded import unfolded_builder
    from deepinv.training_utils import train, test
    from torchvision import transforms
    from deepinv.utils.phantoms import RandomPhantomDataset, SheppLoganDataset
    from deepinv.optim.optim_iterators import CPIteration, fStep, gStep
    from deepinv.models import PDNet_PrimalBlock, PDNet_DualBlock
    from deepinv.optim import Prior, DataFidelity








.. GENERATED FROM PYTHON SOURCE LINES 29-32

Setup paths for data loading and results.
----------------------------------------------------------------------------------------


.. GENERATED FROM PYTHON SOURCE LINES 32-44

.. code-block:: Python


    BASE_DIR = Path(".")
    ORIGINAL_DATA_DIR = BASE_DIR / "datasets"
    DATA_DIR = BASE_DIR / "measurements"
    RESULTS_DIR = BASE_DIR / "results"
    CKPT_DIR = BASE_DIR / "ckpts"

    # Set the global random seed from pytorch to ensure reproducibility of the example.
    torch.manual_seed(0)

    device = dinv.utils.get_freer_gpu() if torch.cuda.is_available() else "cpu"








.. GENERATED FROM PYTHON SOURCE LINES 45-48

Load base image datasets and degradation operators.
---------------------------------------------------
In this example, we use the CBSD500 dataset for training and the Set3C dataset for testing.

.. GENERATED FROM PYTHON SOURCE LINES 48-66

.. code-block:: Python


    img_size = 128 if torch.cuda.is_available() else 32
    n_channels = 1  # 3 for color images, 1 for gray-scale images
    operation = "CT"

    # Degradation parameters
    noise_level_img = 0.05

    # Generate the CT operator.
    physics = dinv.physics.Tomography(
        img_width=img_size,
        angles=30,
        circle=False,
        device=device,
        noise_model=dinv.physics.GaussianNoise(sigma=noise_level_img),
    )









.. GENERATED FROM PYTHON SOURCE LINES 67-73

Define a custom iterator for the PDNet learned primal-dual algorithm.
---------------------------------------------------------------------
The iterator is a subclass of the Chambolle-Pock iterator :meth:`deepinv.optim.optim_iterators.PDIteration`.
In PDNet, the primal (gStep) and dual (fStep) updates are directly replaced by neural networks.
We thus redefine the fStep and gStep classes as simple proximal operators of the data fidelity and prior, respectively.
Afterwards, both the data fidelity and the prior proximal operators are defined as trainable models.

.. GENERATED FROM PYTHON SOURCE LINES 73-126

.. code-block:: Python



    class PDNetIteration(CPIteration):
        r"""Single iteration of learned primal dual.
        We only redefine the fStep and gStep classes.
        The forward method is inherited from the CPIteration class.
        """

        def __init__(self, **kwargs):
            super().__init__(**kwargs)
            self.g_step = gStepPDNet(**kwargs)
            self.f_step = fStepPDNet(**kwargs)


    class fStepPDNet(fStep):
        r"""
        Dual update of the PDNet algorithm.
        We write it as a proximal operator of the data fidelity term.
        This proximal mapping is to be replaced by a trainable model.
        """

        def __init__(self, **kwargs):
            super().__init__(**kwargs)

        def forward(self, x, w, cur_data_fidelity, y, *args):
            r"""
            :param torch.Tensor x: Current first variable :math:`u`.
            :param torch.Tensor w: Current second variable :math:`A z`.
            :param deepinv.optim.data_fidelity cur_data_fidelity: Instance of the DataFidelity class defining the current data fidelity term.
            :param torch.Tensor y: Input data.
            """
            return cur_data_fidelity.prox(x, w, y)


    class gStepPDNet(gStep):
        r"""
        Primal update of the PDNet algorithm.
        We write it as a proximal operator of the prior term.
        This proximal mapping is to be replaced by a trainable model.
        """

        def __init__(self, **kwargs):
            super().__init__(**kwargs)

        def forward(self, x, w, cur_prior, *args):
            r"""
            :param torch.Tensor x: Current first variable :math:`x`.
            :param torch.Tensor w: Current second variable :math:`A^\top u`.
            :param deepinv.optim.prior cur_prior: Instance of the Prior class defining the current prior.
            """
            return cur_prior.prox(x, w)









.. GENERATED FROM PYTHON SOURCE LINES 127-131

Define the trainable prior and data fidelity terms.
---------------------------------------------------
Prior and data-fidelity are respectively defined as subclass of :meth:`deepinv.optim.Prior` and :meth:`deepinv.optim.DataFidelity`.
Their proximal operators are replaced by trainable models.

.. GENERATED FROM PYTHON SOURCE LINES 131-167

.. code-block:: Python



    class PDNetPrior(Prior):
        def __init__(self, model, *args, **kwargs):
            super().__init__(*args, **kwargs)
            self.model = model

        def prox(self, x, w):
            return self.model(x, w[:, 0:1, :, :])


    class PDNetDataFid(DataFidelity):
        def __init__(self, model, *args, **kwargs):
            super().__init__(*args, **kwargs)
            self.model = model

        def prox(self, x, w, y):
            return self.model(x, w[:, 1:2, :, :], y)


    # Unrolled optimization algorithm parameters
    max_iter = 10 if torch.cuda.is_available() else 3  # number of unfolded layers

    # Set up the data fidelity term. Each layer has its own data fidelity module.
    data_fidelity = [
        PDNetDataFid(model=PDNet_DualBlock().to(device)) for i in range(max_iter)
    ]

    # Set up the trainable prior. Each layer has its own prior module.
    prior = [PDNetPrior(model=PDNet_PrimalBlock().to(device)) for i in range(max_iter)]

    # Logging parameters
    verbose = True
    wandb_vis = False  # plot curves and images in Weight&Bias









.. GENERATED FROM PYTHON SOURCE LINES 168-171

Define the training parameters.
-------------------------------
We use the Adam optimizer and the StepLR scheduler.

.. GENERATED FROM PYTHON SOURCE LINES 171-184

.. code-block:: Python


    # training parameters
    epochs = 10
    learning_rate = 1e-3
    num_workers = 4 if torch.cuda.is_available() else 0
    train_batch_size = 5
    test_batch_size = 1
    n_iter_training = int(1e5) if torch.cuda.is_available() else 1000
    n_data = 1  # number of channels in the input
    n_primal = 5  # extend the primal space
    n_dual = 5  # extend the dual space









.. GENERATED FROM PYTHON SOURCE LINES 185-187

Define the model.
-------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 187-219

.. code-block:: Python



    def custom_init(y, physics):
        x0 = physics.A_dagger(y).repeat(1, n_primal, 1, 1)
        u0 = torch.zeros_like(y).repeat(1, n_dual, 1, 1)
        return {"est": (x0, x0, u0)}


    def custom_output(X):
        return X["est"][0][:, 1, :, :].unsqueeze(1)


    # Define the unfolded trainable model.
    model = unfolded_builder(
        iteration=PDNetIteration(),
        params_algo={"K": physics.A, "K_adjoint": physics.A_adjoint, "beta": 0.0},
        data_fidelity=data_fidelity,
        prior=prior,
        max_iter=max_iter,
        custom_init=custom_init,
        get_output=custom_output,
    )

    # choose optimizer and scheduler
    optimizer = torch.optim.Adam(model.parameters(), lr=learning_rate, betas=(0.9, 0.99))
    scheduler = torch.optim.lr_scheduler.CosineAnnealingLR(
        optimizer=optimizer, T_max=epochs
    )

    # choose supervised training loss
    losses = [dinv.loss.SupLoss(metric=dinv.metric.mse())]








.. GENERATED FROM PYTHON SOURCE LINES 220-222

Training dataset of random phantoms.
--------------------------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 222-238

.. code-block:: Python


    # Define the base train and test datasets of clean images.
    train_dataset_name = "random_phantom"
    train_dataset = RandomPhantomDataset(
        size=img_size, n_data=1, length=n_iter_training // epochs
    )
    test_dataset = SheppLoganDataset(size=img_size, n_data=1)

    train_dataloader = DataLoader(
        train_dataset, batch_size=train_batch_size, num_workers=num_workers
    )
    test_dataloader = DataLoader(
        test_dataset, batch_size=test_batch_size, num_workers=num_workers
    )









.. GENERATED FROM PYTHON SOURCE LINES 239-242

Train the network
----------------------------------------------------------------------------------------
We train the network using the library's train function.

.. GENERATED FROM PYTHON SOURCE LINES 242-259

.. code-block:: Python


    train(
        model=model,
        train_dataloader=train_dataloader,
        eval_dataloader=test_dataloader,
        epochs=epochs,
        scheduler=scheduler,
        losses=losses,
        physics=physics,
        optimizer=optimizer,
        device=device,
        save_path=str(CKPT_DIR / operation),
        verbose=verbose,
        wandb_vis=wandb_vis,  # training visualization can be done in Weight&Bias
        online_measurements=True,
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    The model has 75594 trainable parameters
      0%|          | 0/20 [00:00<?, ?it/s]    Epoch 1:   0%|          | 0/20 [00:00<?, ?it/s]    Epoch 1:   0%|          | 0/20 [00:00<?, ?it/s, eval_psnr=18.2, total_loss=0.0033, train_psnr=25.3]    Epoch 1:   5%|▌         | 1/20 [00:00<00:02,  8.45it/s, eval_psnr=18.2, total_loss=0.0033, train_psnr=25.3]    Epoch 1:   5%|▌         | 1/20 [00:00<00:02,  8.45it/s, eval_psnr=18.2, total_loss=0.0033, train_psnr=25.3]    Epoch 1:   5%|▌         | 1/20 [00:00<00:02,  8.45it/s, eval_psnr=18.2, total_loss=0.0084, train_psnr=22.3]    Epoch 1:  10%|█         | 2/20 [00:00<00:02,  8.75it/s, eval_psnr=18.2, total_loss=0.0084, train_psnr=22.3]    Epoch 1:  10%|█         | 2/20 [00:00<00:02,  8.75it/s, eval_psnr=18.2, total_loss=0.0084, train_psnr=22.3]    Epoch 1:  10%|█         | 2/20 [00:00<00:02,  8.75it/s, eval_psnr=18.2, total_loss=0.00714, train_psnr=22.8]    Epoch 1:  15%|█▌        | 3/20 [00:00<00:01,  8.74it/s, eval_psnr=18.2, total_loss=0.00714, train_psnr=22.8]    Epoch 1:  15%|█▌        | 3/20 [00:00<00:01,  8.74it/s, eval_psnr=18.2, total_loss=0.00714, train_psnr=22.8]    Epoch 1:  15%|█▌        | 3/20 [00:00<00:01,  8.74it/s, eval_psnr=18.2, total_loss=0.00646, train_psnr=23]      Epoch 1:  20%|██        | 4/20 [00:00<00:01,  8.54it/s, eval_psnr=18.2, total_loss=0.00646, train_psnr=23]    Epoch 1:  20%|██        | 4/20 [00:00<00:01,  8.54it/s, eval_psnr=18.2, total_loss=0.00646, train_psnr=23]    Epoch 1:  20%|██        | 4/20 [00:00<00:01,  8.54it/s, eval_psnr=18.2, total_loss=0.00648, train_psnr=22.8]    Epoch 1:  25%|██▌       | 5/20 [00:00<00:01,  8.63it/s, eval_psnr=18.2, total_loss=0.00648, train_psnr=22.8]    Epoch 1:  25%|██▌       | 5/20 [00:00<00:01,  8.63it/s, eval_psnr=18.2, total_loss=0.00648, train_psnr=22.8]    Epoch 1:  25%|██▌       | 5/20 [00:00<00:01,  8.63it/s, eval_psnr=18.2, total_loss=0.00599, train_psnr=23.2]    Epoch 1:  30%|███       | 6/20 [00:00<00:01,  8.51it/s, eval_psnr=18.2, total_loss=0.00599, train_psnr=23.2]    Epoch 1:  30%|███       | 6/20 [00:00<00:01,  8.51it/s, eval_psnr=18.2, total_loss=0.00599, train_psnr=23.2]    Epoch 1:  30%|███       | 6/20 [00:00<00:01,  8.51it/s, eval_psnr=18.2, total_loss=0.00564, train_psnr=23.4]    Epoch 1:  35%|███▌      | 7/20 [00:00<00:01,  8.37it/s, eval_psnr=18.2, total_loss=0.00564, train_psnr=23.4]    Epoch 1:  35%|███▌      | 7/20 [00:00<00:01,  8.37it/s, eval_psnr=18.2, total_loss=0.00564, train_psnr=23.4]    Epoch 1:  35%|███▌      | 7/20 [00:00<00:01,  8.37it/s, eval_psnr=18.2, total_loss=0.00521, train_psnr=23.8]    Epoch 1:  40%|████      | 8/20 [00:00<00:01,  8.17it/s, eval_psnr=18.2, total_loss=0.00521, train_psnr=23.8]    Epoch 1:  40%|████      | 8/20 [00:00<00:01,  8.17it/s, eval_psnr=18.2, total_loss=0.00521, train_psnr=23.8]    Epoch 1:  40%|████      | 8/20 [00:01<00:01,  8.17it/s, eval_psnr=18.2, total_loss=0.00488, train_psnr=24.2]    Epoch 1:  45%|████▌     | 9/20 [00:01<00:01,  8.40it/s, eval_psnr=18.2, total_loss=0.00488, train_psnr=24.2]    Epoch 1:  45%|████▌     | 9/20 [00:01<00:01,  8.40it/s, eval_psnr=18.2, total_loss=0.00488, train_psnr=24.2]    Epoch 1:  45%|████▌     | 9/20 [00:01<00:01,  8.40it/s, eval_psnr=18.2, total_loss=0.00477, train_psnr=24.2]    Epoch 1:  50%|█████     | 10/20 [00:01<00:01,  8.52it/s, eval_psnr=18.2, total_loss=0.00477, train_psnr=24.2]    Epoch 1:  50%|█████     | 10/20 [00:01<00:01,  8.52it/s, eval_psnr=18.2, total_loss=0.00477, train_psnr=24.2]    Epoch 1:  50%|█████     | 10/20 [00:01<00:01,  8.52it/s, eval_psnr=18.2, total_loss=0.00455, train_psnr=24.4]    Epoch 1:  55%|█████▌    | 11/20 [00:01<00:01,  8.41it/s, eval_psnr=18.2, total_loss=0.00455, train_psnr=24.4]    Epoch 1:  55%|█████▌    | 11/20 [00:01<00:01,  8.41it/s, eval_psnr=18.2, total_loss=0.00455, train_psnr=24.4]    Epoch 1:  55%|█████▌    | 11/20 [00:01<00:01,  8.41it/s, eval_psnr=18.2, total_loss=0.00436, train_psnr=24.6]    Epoch 1:  60%|██████    | 12/20 [00:01<00:00,  8.53it/s, eval_psnr=18.2, total_loss=0.00436, train_psnr=24.6]    Epoch 1:  60%|██████    | 12/20 [00:01<00:00,  8.53it/s, eval_psnr=18.2, total_loss=0.00436, train_psnr=24.6]    Epoch 1:  60%|██████    | 12/20 [00:01<00:00,  8.53it/s, eval_psnr=18.2, total_loss=0.00417, train_psnr=24.9]    Epoch 1:  65%|██████▌   | 13/20 [00:01<00:00,  8.62it/s, eval_psnr=18.2, total_loss=0.00417, train_psnr=24.9]    Epoch 1:  65%|██████▌   | 13/20 [00:01<00:00,  8.62it/s, eval_psnr=18.2, total_loss=0.00417, train_psnr=24.9]    Epoch 1:  65%|██████▌   | 13/20 [00:01<00:00,  8.62it/s, eval_psnr=18.2, total_loss=0.00403, train_psnr=25]      Epoch 1:  70%|███████   | 14/20 [00:01<00:00,  8.72it/s, eval_psnr=18.2, total_loss=0.00403, train_psnr=25]    Epoch 1:  70%|███████   | 14/20 [00:01<00:00,  8.72it/s, eval_psnr=18.2, total_loss=0.00403, train_psnr=25]    Epoch 1:  70%|███████   | 14/20 [00:01<00:00,  8.72it/s, eval_psnr=18.2, total_loss=0.00388, train_psnr=25.2]    Epoch 1:  75%|███████▌  | 15/20 [00:01<00:00,  8.79it/s, eval_psnr=18.2, total_loss=0.00388, train_psnr=25.2]    Epoch 1:  75%|███████▌  | 15/20 [00:01<00:00,  8.79it/s, eval_psnr=18.2, total_loss=0.00388, train_psnr=25.2]    Epoch 1:  75%|███████▌  | 15/20 [00:01<00:00,  8.79it/s, eval_psnr=18.2, total_loss=0.00374, train_psnr=25.4]    Epoch 1:  80%|████████  | 16/20 [00:01<00:00,  8.83it/s, eval_psnr=18.2, total_loss=0.00374, train_psnr=25.4]    Epoch 1:  80%|████████  | 16/20 [00:01<00:00,  8.83it/s, eval_psnr=18.2, total_loss=0.00374, train_psnr=25.4]    Epoch 1:  80%|████████  | 16/20 [00:01<00:00,  8.83it/s, eval_psnr=18.2, total_loss=0.00363, train_psnr=25.5]    Epoch 1:  85%|████████▌ | 17/20 [00:01<00:00,  8.85it/s, eval_psnr=18.2, total_loss=0.00363, train_psnr=25.5]    Epoch 1:  85%|████████▌ | 17/20 [00:01<00:00,  8.85it/s, eval_psnr=18.2, total_loss=0.00363, train_psnr=25.5]    Epoch 1:  85%|████████▌ | 17/20 [00:02<00:00,  8.85it/s, eval_psnr=18.2, total_loss=0.00358, train_psnr=25.5]    Epoch 1:  90%|█████████ | 18/20 [00:02<00:00,  8.88it/s, eval_psnr=18.2, total_loss=0.00358, train_psnr=25.5]    Epoch 1:  90%|█████████ | 18/20 [00:02<00:00,  8.88it/s, eval_psnr=18.2, total_loss=0.00358, train_psnr=25.5]    Epoch 1:  90%|█████████ | 18/20 [00:02<00:00,  8.88it/s, eval_psnr=18.2, total_loss=0.00351, train_psnr=25.6]    Epoch 1:  95%|█████████▌| 19/20 [00:02<00:00,  8.91it/s, eval_psnr=18.2, total_loss=0.00351, train_psnr=25.6]    Epoch 1:  95%|█████████▌| 19/20 [00:02<00:00,  8.91it/s, eval_psnr=18.2, total_loss=0.00351, train_psnr=25.6]    Epoch 1:  95%|█████████▌| 19/20 [00:02<00:00,  8.91it/s, eval_psnr=18.2, total_loss=0.00344, train_psnr=25.7]    Epoch 1: 100%|██████████| 20/20 [00:02<00:00,  8.85it/s, eval_psnr=18.2, total_loss=0.00344, train_psnr=25.7]    Epoch 1: 100%|██████████| 20/20 [00:02<00:00,  8.65it/s, eval_psnr=18.2, total_loss=0.00344, train_psnr=25.7]
      0%|          | 0/20 [00:00<?, ?it/s]    Epoch 2:   0%|          | 0/20 [00:00<?, ?it/s]    Epoch 2:   0%|          | 0/20 [00:00<?, ?it/s, eval_psnr=20, total_loss=0.00254, train_psnr=26.9]    Epoch 2:   5%|▌         | 1/20 [00:00<00:02,  8.91it/s, eval_psnr=20, total_loss=0.00254, train_psnr=26.9]    Epoch 2:   5%|▌         | 1/20 [00:00<00:02,  8.91it/s, eval_psnr=20, total_loss=0.00254, train_psnr=26.9]    Epoch 2:   5%|▌         | 1/20 [00:00<00:02,  8.91it/s, eval_psnr=20, total_loss=0.00274, train_psnr=26.2]    Epoch 2:  10%|█         | 2/20 [00:00<00:02,  8.93it/s, eval_psnr=20, total_loss=0.00274, train_psnr=26.2]    Epoch 2:  10%|█         | 2/20 [00:00<00:02,  8.93it/s, eval_psnr=20, total_loss=0.00274, train_psnr=26.2]    Epoch 2:  10%|█         | 2/20 [00:00<00:02,  8.93it/s, eval_psnr=20, total_loss=0.00277, train_psnr=26.1]    Epoch 2:  15%|█▌        | 3/20 [00:00<00:01,  8.91it/s, eval_psnr=20, total_loss=0.00277, train_psnr=26.1]    Epoch 2:  15%|█▌        | 3/20 [00:00<00:01,  8.91it/s, eval_psnr=20, total_loss=0.00277, train_psnr=26.1]    Epoch 2:  15%|█▌        | 3/20 [00:00<00:01,  8.91it/s, eval_psnr=20, total_loss=0.00253, train_psnr=26.5]    Epoch 2:  20%|██        | 4/20 [00:00<00:01,  8.93it/s, eval_psnr=20, total_loss=0.00253, train_psnr=26.5]    Epoch 2:  20%|██        | 4/20 [00:00<00:01,  8.93it/s, eval_psnr=20, total_loss=0.00253, train_psnr=26.5]    Epoch 2:  20%|██        | 4/20 [00:00<00:01,  8.93it/s, eval_psnr=20, total_loss=0.00249, train_psnr=26.5]    Epoch 2:  25%|██▌       | 5/20 [00:00<00:01,  8.90it/s, eval_psnr=20, total_loss=0.00249, train_psnr=26.5]    Epoch 2:  25%|██▌       | 5/20 [00:00<00:01,  8.90it/s, eval_psnr=20, total_loss=0.00249, train_psnr=26.5]    Epoch 2:  25%|██▌       | 5/20 [00:00<00:01,  8.90it/s, eval_psnr=20, total_loss=0.00249, train_psnr=26.5]    Epoch 2:  30%|███       | 6/20 [00:00<00:01,  8.90it/s, eval_psnr=20, total_loss=0.00249, train_psnr=26.5]    Epoch 2:  30%|███       | 6/20 [00:00<00:01,  8.90it/s, eval_psnr=20, total_loss=0.00249, train_psnr=26.5]    Epoch 2:  30%|███       | 6/20 [00:00<00:01,  8.90it/s, eval_psnr=20, total_loss=0.00245, train_psnr=26.6]    Epoch 2:  35%|███▌      | 7/20 [00:00<00:01,  8.93it/s, eval_psnr=20, total_loss=0.00245, train_psnr=26.6]    Epoch 2:  35%|███▌      | 7/20 [00:00<00:01,  8.93it/s, eval_psnr=20, total_loss=0.00245, train_psnr=26.6]    Epoch 2:  35%|███▌      | 7/20 [00:00<00:01,  8.93it/s, eval_psnr=20, total_loss=0.00249, train_psnr=26.6]    Epoch 2:  40%|████      | 8/20 [00:00<00:01,  8.93it/s, eval_psnr=20, total_loss=0.00249, train_psnr=26.6]    Epoch 2:  40%|████      | 8/20 [00:00<00:01,  8.93it/s, eval_psnr=20, total_loss=0.00249, train_psnr=26.6]    Epoch 2:  40%|████      | 8/20 [00:01<00:01,  8.93it/s, eval_psnr=20, total_loss=0.00259, train_psnr=26.5]    Epoch 2:  45%|████▌     | 9/20 [00:01<00:01,  8.81it/s, eval_psnr=20, total_loss=0.00259, train_psnr=26.5]    Epoch 2:  45%|████▌     | 9/20 [00:01<00:01,  8.81it/s, eval_psnr=20, total_loss=0.00259, train_psnr=26.5]    Epoch 2:  45%|████▌     | 9/20 [00:01<00:01,  8.81it/s, eval_psnr=20, total_loss=0.00251, train_psnr=26.6]    Epoch 2:  50%|█████     | 10/20 [00:01<00:01,  8.73it/s, eval_psnr=20, total_loss=0.00251, train_psnr=26.6]    Epoch 2:  50%|█████     | 10/20 [00:01<00:01,  8.73it/s, eval_psnr=20, total_loss=0.00251, train_psnr=26.6]    Epoch 2:  50%|█████     | 10/20 [00:01<00:01,  8.73it/s, eval_psnr=20, total_loss=0.00255, train_psnr=26.5]    Epoch 2:  55%|█████▌    | 11/20 [00:01<00:01,  8.80it/s, eval_psnr=20, total_loss=0.00255, train_psnr=26.5]    Epoch 2:  55%|█████▌    | 11/20 [00:01<00:01,  8.80it/s, eval_psnr=20, total_loss=0.00255, train_psnr=26.5]    Epoch 2:  55%|█████▌    | 11/20 [00:01<00:01,  8.80it/s, eval_psnr=20, total_loss=0.00248, train_psnr=26.6]    Epoch 2:  60%|██████    | 12/20 [00:01<00:00,  8.82it/s, eval_psnr=20, total_loss=0.00248, train_psnr=26.6]    Epoch 2:  60%|██████    | 12/20 [00:01<00:00,  8.82it/s, eval_psnr=20, total_loss=0.00248, train_psnr=26.6]    Epoch 2:  60%|██████    | 12/20 [00:01<00:00,  8.82it/s, eval_psnr=20, total_loss=0.00249, train_psnr=26.6]    Epoch 2:  65%|██████▌   | 13/20 [00:01<00:00,  8.83it/s, eval_psnr=20, total_loss=0.00249, train_psnr=26.6]    Epoch 2:  65%|██████▌   | 13/20 [00:01<00:00,  8.83it/s, eval_psnr=20, total_loss=0.00249, train_psnr=26.6]    Epoch 2:  65%|██████▌   | 13/20 [00:01<00:00,  8.83it/s, eval_psnr=20, total_loss=0.00244, train_psnr=26.7]    Epoch 2:  70%|███████   | 14/20 [00:01<00:00,  8.87it/s, eval_psnr=20, total_loss=0.00244, train_psnr=26.7]    Epoch 2:  70%|███████   | 14/20 [00:01<00:00,  8.87it/s, eval_psnr=20, total_loss=0.00244, train_psnr=26.7]    Epoch 2:  70%|███████   | 14/20 [00:01<00:00,  8.87it/s, eval_psnr=20, total_loss=0.0024, train_psnr=26.7]     Epoch 2:  75%|███████▌  | 15/20 [00:01<00:00,  8.86it/s, eval_psnr=20, total_loss=0.0024, train_psnr=26.7]    Epoch 2:  75%|███████▌  | 15/20 [00:01<00:00,  8.86it/s, eval_psnr=20, total_loss=0.0024, train_psnr=26.7]    Epoch 2:  75%|███████▌  | 15/20 [00:01<00:00,  8.86it/s, eval_psnr=20, total_loss=0.00238, train_psnr=26.7]    Epoch 2:  80%|████████  | 16/20 [00:01<00:00,  8.86it/s, eval_psnr=20, total_loss=0.00238, train_psnr=26.7]    Epoch 2:  80%|████████  | 16/20 [00:01<00:00,  8.86it/s, eval_psnr=20, total_loss=0.00238, train_psnr=26.7]    Epoch 2:  80%|████████  | 16/20 [00:01<00:00,  8.86it/s, eval_psnr=20, total_loss=0.00236, train_psnr=26.8]    Epoch 2:  85%|████████▌ | 17/20 [00:01<00:00,  8.85it/s, eval_psnr=20, total_loss=0.00236, train_psnr=26.8]    Epoch 2:  85%|████████▌ | 17/20 [00:01<00:00,  8.85it/s, eval_psnr=20, total_loss=0.00236, train_psnr=26.8]    Epoch 2:  85%|████████▌ | 17/20 [00:02<00:00,  8.85it/s, eval_psnr=20, total_loss=0.00229, train_psnr=26.9]    Epoch 2:  90%|█████████ | 18/20 [00:02<00:00,  8.86it/s, eval_psnr=20, total_loss=0.00229, train_psnr=26.9]    Epoch 2:  90%|█████████ | 18/20 [00:02<00:00,  8.86it/s, eval_psnr=20, total_loss=0.00229, train_psnr=26.9]    Epoch 2:  90%|█████████ | 18/20 [00:02<00:00,  8.86it/s, eval_psnr=20, total_loss=0.00227, train_psnr=27]      Epoch 2:  95%|█████████▌| 19/20 [00:02<00:00,  8.58it/s, eval_psnr=20, total_loss=0.00227, train_psnr=27]    Epoch 2:  95%|█████████▌| 19/20 [00:02<00:00,  8.58it/s, eval_psnr=20, total_loss=0.00227, train_psnr=27]    Epoch 2:  95%|█████████▌| 19/20 [00:02<00:00,  8.58it/s, eval_psnr=20, total_loss=0.00224, train_psnr=27]    Epoch 2: 100%|██████████| 20/20 [00:02<00:00,  8.68it/s, eval_psnr=20, total_loss=0.00224, train_psnr=27]    Epoch 2: 100%|██████████| 20/20 [00:02<00:00,  8.81it/s, eval_psnr=20, total_loss=0.00224, train_psnr=27]
      0%|          | 0/20 [00:00<?, ?it/s]    Epoch 3:   0%|          | 0/20 [00:00<?, ?it/s]    Epoch 3:   0%|          | 0/20 [00:00<?, ?it/s, eval_psnr=20.3, total_loss=0.00132, train_psnr=28.9]    Epoch 3:   5%|▌         | 1/20 [00:00<00:02,  8.96it/s, eval_psnr=20.3, total_loss=0.00132, train_psnr=28.9]    Epoch 3:   5%|▌         | 1/20 [00:00<00:02,  8.96it/s, eval_psnr=20.3, total_loss=0.00132, train_psnr=28.9]    Epoch 3:   5%|▌         | 1/20 [00:00<00:02,  8.96it/s, eval_psnr=20.3, total_loss=0.00204, train_psnr=27.6]    Epoch 3:  10%|█         | 2/20 [00:00<00:02,  8.87it/s, eval_psnr=20.3, total_loss=0.00204, train_psnr=27.6]    Epoch 3:  10%|█         | 2/20 [00:00<00:02,  8.87it/s, eval_psnr=20.3, total_loss=0.00204, train_psnr=27.6]    Epoch 3:  10%|█         | 2/20 [00:00<00:02,  8.87it/s, eval_psnr=20.3, total_loss=0.00179, train_psnr=28.2]    Epoch 3:  15%|█▌        | 3/20 [00:00<00:01,  8.93it/s, eval_psnr=20.3, total_loss=0.00179, train_psnr=28.2]    Epoch 3:  15%|█▌        | 3/20 [00:00<00:01,  8.93it/s, eval_psnr=20.3, total_loss=0.00179, train_psnr=28.2]    Epoch 3:  15%|█▌        | 3/20 [00:00<00:01,  8.93it/s, eval_psnr=20.3, total_loss=0.002, train_psnr=27.6]      Epoch 3:  20%|██        | 4/20 [00:00<00:01,  8.95it/s, eval_psnr=20.3, total_loss=0.002, train_psnr=27.6]    Epoch 3:  20%|██        | 4/20 [00:00<00:01,  8.95it/s, eval_psnr=20.3, total_loss=0.002, train_psnr=27.6]    Epoch 3:  20%|██        | 4/20 [00:00<00:01,  8.95it/s, eval_psnr=20.3, total_loss=0.00193, train_psnr=27.8]    Epoch 3:  25%|██▌       | 5/20 [00:00<00:01,  9.00it/s, eval_psnr=20.3, total_loss=0.00193, train_psnr=27.8]    Epoch 3:  25%|██▌       | 5/20 [00:00<00:01,  9.00it/s, eval_psnr=20.3, total_loss=0.00193, train_psnr=27.8]    Epoch 3:  25%|██▌       | 5/20 [00:00<00:01,  9.00it/s, eval_psnr=20.3, total_loss=0.00188, train_psnr=27.8]    Epoch 3:  30%|███       | 6/20 [00:00<00:01,  9.00it/s, eval_psnr=20.3, total_loss=0.00188, train_psnr=27.8]    Epoch 3:  30%|███       | 6/20 [00:00<00:01,  9.00it/s, eval_psnr=20.3, total_loss=0.00188, train_psnr=27.8]    Epoch 3:  30%|███       | 6/20 [00:00<00:01,  9.00it/s, eval_psnr=20.3, total_loss=0.00194, train_psnr=27.7]    Epoch 3:  35%|███▌      | 7/20 [00:00<00:01,  8.83it/s, eval_psnr=20.3, total_loss=0.00194, train_psnr=27.7]    Epoch 3:  35%|███▌      | 7/20 [00:00<00:01,  8.83it/s, eval_psnr=20.3, total_loss=0.00194, train_psnr=27.7]    Epoch 3:  35%|███▌      | 7/20 [00:00<00:01,  8.83it/s, eval_psnr=20.3, total_loss=0.00193, train_psnr=27.6]    Epoch 3:  40%|████      | 8/20 [00:00<00:01,  8.72it/s, eval_psnr=20.3, total_loss=0.00193, train_psnr=27.6]    Epoch 3:  40%|████      | 8/20 [00:00<00:01,  8.72it/s, eval_psnr=20.3, total_loss=0.00193, train_psnr=27.6]    Epoch 3:  40%|████      | 8/20 [00:01<00:01,  8.72it/s, eval_psnr=20.3, total_loss=0.00194, train_psnr=27.6]    Epoch 3:  45%|████▌     | 9/20 [00:01<00:01,  8.77it/s, eval_psnr=20.3, total_loss=0.00194, train_psnr=27.6]    Epoch 3:  45%|████▌     | 9/20 [00:01<00:01,  8.77it/s, eval_psnr=20.3, total_loss=0.00194, train_psnr=27.6]    Epoch 3:  45%|████▌     | 9/20 [00:01<00:01,  8.77it/s, eval_psnr=20.3, total_loss=0.00196, train_psnr=27.7]    Epoch 3:  50%|█████     | 10/20 [00:01<00:01,  8.84it/s, eval_psnr=20.3, total_loss=0.00196, train_psnr=27.7]    Epoch 3:  50%|█████     | 10/20 [00:01<00:01,  8.84it/s, eval_psnr=20.3, total_loss=0.00196, train_psnr=27.7]    Epoch 3:  50%|█████     | 10/20 [00:01<00:01,  8.84it/s, eval_psnr=20.3, total_loss=0.00197, train_psnr=27.7]    Epoch 3:  55%|█████▌    | 11/20 [00:01<00:01,  8.86it/s, eval_psnr=20.3, total_loss=0.00197, train_psnr=27.7]    Epoch 3:  55%|█████▌    | 11/20 [00:01<00:01,  8.86it/s, eval_psnr=20.3, total_loss=0.00197, train_psnr=27.7]    Epoch 3:  55%|█████▌    | 11/20 [00:01<00:01,  8.86it/s, eval_psnr=20.3, total_loss=0.00196, train_psnr=27.7]    Epoch 3:  60%|██████    | 12/20 [00:01<00:00,  8.92it/s, eval_psnr=20.3, total_loss=0.00196, train_psnr=27.7]    Epoch 3:  60%|██████    | 12/20 [00:01<00:00,  8.92it/s, eval_psnr=20.3, total_loss=0.00196, train_psnr=27.7]    Epoch 3:  60%|██████    | 12/20 [00:01<00:00,  8.92it/s, eval_psnr=20.3, total_loss=0.00193, train_psnr=27.7]    Epoch 3:  65%|██████▌   | 13/20 [00:01<00:00,  8.92it/s, eval_psnr=20.3, total_loss=0.00193, train_psnr=27.7]    Epoch 3:  65%|██████▌   | 13/20 [00:01<00:00,  8.92it/s, eval_psnr=20.3, total_loss=0.00193, train_psnr=27.7]    Epoch 3:  65%|██████▌   | 13/20 [00:01<00:00,  8.92it/s, eval_psnr=20.3, total_loss=0.00193, train_psnr=27.7]    Epoch 3:  70%|███████   | 14/20 [00:01<00:00,  8.92it/s, eval_psnr=20.3, total_loss=0.00193, train_psnr=27.7]    Epoch 3:  70%|███████   | 14/20 [00:01<00:00,  8.92it/s, eval_psnr=20.3, total_loss=0.00193, train_psnr=27.7]    Epoch 3:  70%|███████   | 14/20 [00:01<00:00,  8.92it/s, eval_psnr=20.3, total_loss=0.00193, train_psnr=27.7]    Epoch 3:  75%|███████▌  | 15/20 [00:01<00:00,  8.91it/s, eval_psnr=20.3, total_loss=0.00193, train_psnr=27.7]    Epoch 3:  75%|███████▌  | 15/20 [00:01<00:00,  8.91it/s, eval_psnr=20.3, total_loss=0.00193, train_psnr=27.7]    Epoch 3:  75%|███████▌  | 15/20 [00:01<00:00,  8.91it/s, eval_psnr=20.3, total_loss=0.00188, train_psnr=27.9]    Epoch 3:  80%|████████  | 16/20 [00:01<00:00,  8.91it/s, eval_psnr=20.3, total_loss=0.00188, train_psnr=27.9]    Epoch 3:  80%|████████  | 16/20 [00:01<00:00,  8.91it/s, eval_psnr=20.3, total_loss=0.00188, train_psnr=27.9]    Epoch 3:  80%|████████  | 16/20 [00:01<00:00,  8.91it/s, eval_psnr=20.3, total_loss=0.00195, train_psnr=27.7]    Epoch 3:  85%|████████▌ | 17/20 [00:01<00:00,  8.85it/s, eval_psnr=20.3, total_loss=0.00195, train_psnr=27.7]    Epoch 3:  85%|████████▌ | 17/20 [00:01<00:00,  8.85it/s, eval_psnr=20.3, total_loss=0.00195, train_psnr=27.7]    Epoch 3:  85%|████████▌ | 17/20 [00:02<00:00,  8.85it/s, eval_psnr=20.3, total_loss=0.00192, train_psnr=27.8]    Epoch 3:  90%|█████████ | 18/20 [00:02<00:00,  8.85it/s, eval_psnr=20.3, total_loss=0.00192, train_psnr=27.8]    Epoch 3:  90%|█████████ | 18/20 [00:02<00:00,  8.85it/s, eval_psnr=20.3, total_loss=0.00192, train_psnr=27.8]    Epoch 3:  90%|█████████ | 18/20 [00:02<00:00,  8.85it/s, eval_psnr=20.3, total_loss=0.00193, train_psnr=27.7]    Epoch 3:  95%|█████████▌| 19/20 [00:02<00:00,  8.89it/s, eval_psnr=20.3, total_loss=0.00193, train_psnr=27.7]    Epoch 3:  95%|█████████▌| 19/20 [00:02<00:00,  8.89it/s, eval_psnr=20.3, total_loss=0.00193, train_psnr=27.7]    Epoch 3:  95%|█████████▌| 19/20 [00:02<00:00,  8.89it/s, eval_psnr=20.3, total_loss=0.00192, train_psnr=27.7]    Epoch 3: 100%|██████████| 20/20 [00:02<00:00,  8.91it/s, eval_psnr=20.3, total_loss=0.00192, train_psnr=27.7]    Epoch 3: 100%|██████████| 20/20 [00:02<00:00,  8.89it/s, eval_psnr=20.3, total_loss=0.00192, train_psnr=27.7]
      0%|          | 0/20 [00:00<?, ?it/s]    Epoch 4:   0%|          | 0/20 [00:00<?, ?it/s]    Epoch 4:   0%|          | 0/20 [00:00<?, ?it/s, eval_psnr=20.4, total_loss=0.00231, train_psnr=26.8]    Epoch 4:   5%|▌         | 1/20 [00:00<00:02,  8.80it/s, eval_psnr=20.4, total_loss=0.00231, train_psnr=26.8]    Epoch 4:   5%|▌         | 1/20 [00:00<00:02,  8.80it/s, eval_psnr=20.4, total_loss=0.00231, train_psnr=26.8]    Epoch 4:   5%|▌         | 1/20 [00:00<00:02,  8.80it/s, eval_psnr=20.4, total_loss=0.00192, train_psnr=27.7]    Epoch 4:  10%|█         | 2/20 [00:00<00:02,  8.83it/s, eval_psnr=20.4, total_loss=0.00192, train_psnr=27.7]    Epoch 4:  10%|█         | 2/20 [00:00<00:02,  8.83it/s, eval_psnr=20.4, total_loss=0.00192, train_psnr=27.7]    Epoch 4:  10%|█         | 2/20 [00:00<00:02,  8.83it/s, eval_psnr=20.4, total_loss=0.00197, train_psnr=27.6]    Epoch 4:  15%|█▌        | 3/20 [00:00<00:01,  8.87it/s, eval_psnr=20.4, total_loss=0.00197, train_psnr=27.6]    Epoch 4:  15%|█▌        | 3/20 [00:00<00:01,  8.87it/s, eval_psnr=20.4, total_loss=0.00197, train_psnr=27.6]    Epoch 4:  15%|█▌        | 3/20 [00:00<00:01,  8.87it/s, eval_psnr=20.4, total_loss=0.00185, train_psnr=27.8]    Epoch 4:  20%|██        | 4/20 [00:00<00:01,  8.87it/s, eval_psnr=20.4, total_loss=0.00185, train_psnr=27.8]    Epoch 4:  20%|██        | 4/20 [00:00<00:01,  8.87it/s, eval_psnr=20.4, total_loss=0.00185, train_psnr=27.8]    Epoch 4:  20%|██        | 4/20 [00:00<00:01,  8.87it/s, eval_psnr=20.4, total_loss=0.00179, train_psnr=27.9]    Epoch 4:  25%|██▌       | 5/20 [00:00<00:01,  8.75it/s, eval_psnr=20.4, total_loss=0.00179, train_psnr=27.9]    Epoch 4:  25%|██▌       | 5/20 [00:00<00:01,  8.75it/s, eval_psnr=20.4, total_loss=0.00179, train_psnr=27.9]    Epoch 4:  25%|██▌       | 5/20 [00:00<00:01,  8.75it/s, eval_psnr=20.4, total_loss=0.00197, train_psnr=27.5]    Epoch 4:  30%|███       | 6/20 [00:00<00:01,  8.59it/s, eval_psnr=20.4, total_loss=0.00197, train_psnr=27.5]    Epoch 4:  30%|███       | 6/20 [00:00<00:01,  8.59it/s, eval_psnr=20.4, total_loss=0.00197, train_psnr=27.5]    Epoch 4:  30%|███       | 6/20 [00:00<00:01,  8.59it/s, eval_psnr=20.4, total_loss=0.0019, train_psnr=27.6]     Epoch 4:  35%|███▌      | 7/20 [00:00<00:01,  8.66it/s, eval_psnr=20.4, total_loss=0.0019, train_psnr=27.6]    Epoch 4:  35%|███▌      | 7/20 [00:00<00:01,  8.66it/s, eval_psnr=20.4, total_loss=0.0019, train_psnr=27.6]    Epoch 4:  35%|███▌      | 7/20 [00:00<00:01,  8.66it/s, eval_psnr=20.4, total_loss=0.00189, train_psnr=27.7]    Epoch 4:  40%|████      | 8/20 [00:00<00:01,  8.74it/s, eval_psnr=20.4, total_loss=0.00189, train_psnr=27.7]    Epoch 4:  40%|████      | 8/20 [00:00<00:01,  8.74it/s, eval_psnr=20.4, total_loss=0.00189, train_psnr=27.7]    Epoch 4:  40%|████      | 8/20 [00:01<00:01,  8.74it/s, eval_psnr=20.4, total_loss=0.0019, train_psnr=27.7]     Epoch 4:  45%|████▌     | 9/20 [00:01<00:01,  8.80it/s, eval_psnr=20.4, total_loss=0.0019, train_psnr=27.7]    Epoch 4:  45%|████▌     | 9/20 [00:01<00:01,  8.80it/s, eval_psnr=20.4, total_loss=0.0019, train_psnr=27.7]    Epoch 4:  45%|████▌     | 9/20 [00:01<00:01,  8.80it/s, eval_psnr=20.4, total_loss=0.00187, train_psnr=27.8]    Epoch 4:  50%|█████     | 10/20 [00:01<00:01,  8.83it/s, eval_psnr=20.4, total_loss=0.00187, train_psnr=27.8]    Epoch 4:  50%|█████     | 10/20 [00:01<00:01,  8.83it/s, eval_psnr=20.4, total_loss=0.00187, train_psnr=27.8]    Epoch 4:  50%|█████     | 10/20 [00:01<00:01,  8.83it/s, eval_psnr=20.4, total_loss=0.00189, train_psnr=27.7]    Epoch 4:  55%|█████▌    | 11/20 [00:01<00:01,  8.84it/s, eval_psnr=20.4, total_loss=0.00189, train_psnr=27.7]    Epoch 4:  55%|█████▌    | 11/20 [00:01<00:01,  8.84it/s, eval_psnr=20.4, total_loss=0.00189, train_psnr=27.7]    Epoch 4:  55%|█████▌    | 11/20 [00:01<00:01,  8.84it/s, eval_psnr=20.4, total_loss=0.00186, train_psnr=27.7]    Epoch 4:  60%|██████    | 12/20 [00:01<00:00,  8.87it/s, eval_psnr=20.4, total_loss=0.00186, train_psnr=27.7]    Epoch 4:  60%|██████    | 12/20 [00:01<00:00,  8.87it/s, eval_psnr=20.4, total_loss=0.00186, train_psnr=27.7]    Epoch 4:  60%|██████    | 12/20 [00:01<00:00,  8.87it/s, eval_psnr=20.4, total_loss=0.00184, train_psnr=27.8]    Epoch 4:  65%|██████▌   | 13/20 [00:01<00:00,  8.89it/s, eval_psnr=20.4, total_loss=0.00184, train_psnr=27.8]    Epoch 4:  65%|██████▌   | 13/20 [00:01<00:00,  8.89it/s, eval_psnr=20.4, total_loss=0.00184, train_psnr=27.8]    Epoch 4:  65%|██████▌   | 13/20 [00:01<00:00,  8.89it/s, eval_psnr=20.4, total_loss=0.00184, train_psnr=27.8]    Epoch 4:  70%|███████   | 14/20 [00:01<00:00,  8.89it/s, eval_psnr=20.4, total_loss=0.00184, train_psnr=27.8]    Epoch 4:  70%|███████   | 14/20 [00:01<00:00,  8.89it/s, eval_psnr=20.4, total_loss=0.00184, train_psnr=27.8]    Epoch 4:  70%|███████   | 14/20 [00:01<00:00,  8.89it/s, eval_psnr=20.4, total_loss=0.00185, train_psnr=27.8]    Epoch 4:  75%|███████▌  | 15/20 [00:01<00:00,  8.86it/s, eval_psnr=20.4, total_loss=0.00185, train_psnr=27.8]    Epoch 4:  75%|███████▌  | 15/20 [00:01<00:00,  8.86it/s, eval_psnr=20.4, total_loss=0.00185, train_psnr=27.8]    Epoch 4:  75%|███████▌  | 15/20 [00:01<00:00,  8.86it/s, eval_psnr=20.4, total_loss=0.0019, train_psnr=27.7]     Epoch 4:  80%|████████  | 16/20 [00:01<00:00,  8.85it/s, eval_psnr=20.4, total_loss=0.0019, train_psnr=27.7]    Epoch 4:  80%|████████  | 16/20 [00:01<00:00,  8.85it/s, eval_psnr=20.4, total_loss=0.0019, train_psnr=27.7]    Epoch 4:  80%|████████  | 16/20 [00:01<00:00,  8.85it/s, eval_psnr=20.4, total_loss=0.0019, train_psnr=27.6]    Epoch 4:  85%|████████▌ | 17/20 [00:01<00:00,  8.86it/s, eval_psnr=20.4, total_loss=0.0019, train_psnr=27.6]    Epoch 4:  85%|████████▌ | 17/20 [00:01<00:00,  8.86it/s, eval_psnr=20.4, total_loss=0.0019, train_psnr=27.6]    Epoch 4:  85%|████████▌ | 17/20 [00:02<00:00,  8.86it/s, eval_psnr=20.4, total_loss=0.0019, train_psnr=27.6]    Epoch 4:  90%|█████████ | 18/20 [00:02<00:00,  8.88it/s, eval_psnr=20.4, total_loss=0.0019, train_psnr=27.6]    Epoch 4:  90%|█████████ | 18/20 [00:02<00:00,  8.88it/s, eval_psnr=20.4, total_loss=0.0019, train_psnr=27.6]    Epoch 4:  90%|█████████ | 18/20 [00:02<00:00,  8.88it/s, eval_psnr=20.4, total_loss=0.0019, train_psnr=27.6]    Epoch 4:  95%|█████████▌| 19/20 [00:02<00:00,  8.85it/s, eval_psnr=20.4, total_loss=0.0019, train_psnr=27.6]    Epoch 4:  95%|█████████▌| 19/20 [00:02<00:00,  8.85it/s, eval_psnr=20.4, total_loss=0.0019, train_psnr=27.6]    Epoch 4:  95%|█████████▌| 19/20 [00:02<00:00,  8.85it/s, eval_psnr=20.4, total_loss=0.00188, train_psnr=27.7]    Epoch 4: 100%|██████████| 20/20 [00:02<00:00,  8.87it/s, eval_psnr=20.4, total_loss=0.00188, train_psnr=27.7]    Epoch 4: 100%|██████████| 20/20 [00:02<00:00,  8.83it/s, eval_psnr=20.4, total_loss=0.00188, train_psnr=27.7]
      0%|          | 0/20 [00:00<?, ?it/s]    Epoch 5:   0%|          | 0/20 [00:00<?, ?it/s]    Epoch 5:   0%|          | 0/20 [00:00<?, ?it/s, eval_psnr=20.5, total_loss=0.00192, train_psnr=27.6]    Epoch 5:   5%|▌         | 1/20 [00:00<00:02,  9.02it/s, eval_psnr=20.5, total_loss=0.00192, train_psnr=27.6]    Epoch 5:   5%|▌         | 1/20 [00:00<00:02,  9.02it/s, eval_psnr=20.5, total_loss=0.00192, train_psnr=27.6]    Epoch 5:   5%|▌         | 1/20 [00:00<00:02,  9.02it/s, eval_psnr=20.5, total_loss=0.00192, train_psnr=27.4]    Epoch 5:  10%|█         | 2/20 [00:00<00:02,  8.86it/s, eval_psnr=20.5, total_loss=0.00192, train_psnr=27.4]    Epoch 5:  10%|█         | 2/20 [00:00<00:02,  8.86it/s, eval_psnr=20.5, total_loss=0.00192, train_psnr=27.4]    Epoch 5:  10%|█         | 2/20 [00:00<00:02,  8.86it/s, eval_psnr=20.5, total_loss=0.00181, train_psnr=27.7]    Epoch 5:  15%|█▌        | 3/20 [00:00<00:02,  8.48it/s, eval_psnr=20.5, total_loss=0.00181, train_psnr=27.7]    Epoch 5:  15%|█▌        | 3/20 [00:00<00:02,  8.48it/s, eval_psnr=20.5, total_loss=0.00181, train_psnr=27.7]    Epoch 5:  15%|█▌        | 3/20 [00:00<00:02,  8.48it/s, eval_psnr=20.5, total_loss=0.00191, train_psnr=27.5]    Epoch 5:  20%|██        | 4/20 [00:00<00:01,  8.65it/s, eval_psnr=20.5, total_loss=0.00191, train_psnr=27.5]    Epoch 5:  20%|██        | 4/20 [00:00<00:01,  8.65it/s, eval_psnr=20.5, total_loss=0.00191, train_psnr=27.5]    Epoch 5:  20%|██        | 4/20 [00:00<00:01,  8.65it/s, eval_psnr=20.5, total_loss=0.0019, train_psnr=27.6]     Epoch 5:  25%|██▌       | 5/20 [00:00<00:01,  8.74it/s, eval_psnr=20.5, total_loss=0.0019, train_psnr=27.6]    Epoch 5:  25%|██▌       | 5/20 [00:00<00:01,  8.74it/s, eval_psnr=20.5, total_loss=0.0019, train_psnr=27.6]    Epoch 5:  25%|██▌       | 5/20 [00:00<00:01,  8.74it/s, eval_psnr=20.5, total_loss=0.00189, train_psnr=27.6]    Epoch 5:  30%|███       | 6/20 [00:00<00:01,  8.80it/s, eval_psnr=20.5, total_loss=0.00189, train_psnr=27.6]    Epoch 5:  30%|███       | 6/20 [00:00<00:01,  8.80it/s, eval_psnr=20.5, total_loss=0.00189, train_psnr=27.6]    Epoch 5:  30%|███       | 6/20 [00:00<00:01,  8.80it/s, eval_psnr=20.5, total_loss=0.00184, train_psnr=27.7]    Epoch 5:  35%|███▌      | 7/20 [00:00<00:01,  8.81it/s, eval_psnr=20.5, total_loss=0.00184, train_psnr=27.7]    Epoch 5:  35%|███▌      | 7/20 [00:00<00:01,  8.81it/s, eval_psnr=20.5, total_loss=0.00184, train_psnr=27.7]    Epoch 5:  35%|███▌      | 7/20 [00:00<00:01,  8.81it/s, eval_psnr=20.5, total_loss=0.00177, train_psnr=27.9]    Epoch 5:  40%|████      | 8/20 [00:00<00:01,  8.80it/s, eval_psnr=20.5, total_loss=0.00177, train_psnr=27.9]    Epoch 5:  40%|████      | 8/20 [00:00<00:01,  8.80it/s, eval_psnr=20.5, total_loss=0.00177, train_psnr=27.9]    Epoch 5:  40%|████      | 8/20 [00:01<00:01,  8.80it/s, eval_psnr=20.5, total_loss=0.00181, train_psnr=27.8]    Epoch 5:  45%|████▌     | 9/20 [00:01<00:01,  8.83it/s, eval_psnr=20.5, total_loss=0.00181, train_psnr=27.8]    Epoch 5:  45%|████▌     | 9/20 [00:01<00:01,  8.83it/s, eval_psnr=20.5, total_loss=0.00181, train_psnr=27.8]    Epoch 5:  45%|████▌     | 9/20 [00:01<00:01,  8.83it/s, eval_psnr=20.5, total_loss=0.00179, train_psnr=27.8]    Epoch 5:  50%|█████     | 10/20 [00:01<00:01,  8.84it/s, eval_psnr=20.5, total_loss=0.00179, train_psnr=27.8]    Epoch 5:  50%|█████     | 10/20 [00:01<00:01,  8.84it/s, eval_psnr=20.5, total_loss=0.00179, train_psnr=27.8]    Epoch 5:  50%|█████     | 10/20 [00:01<00:01,  8.84it/s, eval_psnr=20.5, total_loss=0.0018, train_psnr=27.8]     Epoch 5:  55%|█████▌    | 11/20 [00:01<00:01,  8.87it/s, eval_psnr=20.5, total_loss=0.0018, train_psnr=27.8]    Epoch 5:  55%|█████▌    | 11/20 [00:01<00:01,  8.87it/s, eval_psnr=20.5, total_loss=0.0018, train_psnr=27.8]    Epoch 5:  55%|█████▌    | 11/20 [00:01<00:01,  8.87it/s, eval_psnr=20.5, total_loss=0.00179, train_psnr=27.8]    Epoch 5:  60%|██████    | 12/20 [00:01<00:00,  8.84it/s, eval_psnr=20.5, total_loss=0.00179, train_psnr=27.8]    Epoch 5:  60%|██████    | 12/20 [00:01<00:00,  8.84it/s, eval_psnr=20.5, total_loss=0.00179, train_psnr=27.8]    Epoch 5:  60%|██████    | 12/20 [00:01<00:00,  8.84it/s, eval_psnr=20.5, total_loss=0.00184, train_psnr=27.7]    Epoch 5:  65%|██████▌   | 13/20 [00:01<00:00,  8.82it/s, eval_psnr=20.5, total_loss=0.00184, train_psnr=27.7]    Epoch 5:  65%|██████▌   | 13/20 [00:01<00:00,  8.82it/s, eval_psnr=20.5, total_loss=0.00184, train_psnr=27.7]    Epoch 5:  65%|██████▌   | 13/20 [00:01<00:00,  8.82it/s, eval_psnr=20.5, total_loss=0.00183, train_psnr=27.7]    Epoch 5:  70%|███████   | 14/20 [00:01<00:00,  8.84it/s, eval_psnr=20.5, total_loss=0.00183, train_psnr=27.7]    Epoch 5:  70%|███████   | 14/20 [00:01<00:00,  8.84it/s, eval_psnr=20.5, total_loss=0.00183, train_psnr=27.7]    Epoch 5:  70%|███████   | 14/20 [00:01<00:00,  8.84it/s, eval_psnr=20.5, total_loss=0.00183, train_psnr=27.7]    Epoch 5:  75%|███████▌  | 15/20 [00:01<00:00,  8.84it/s, eval_psnr=20.5, total_loss=0.00183, train_psnr=27.7]    Epoch 5:  75%|███████▌  | 15/20 [00:01<00:00,  8.84it/s, eval_psnr=20.5, total_loss=0.00183, train_psnr=27.7]    Epoch 5:  75%|███████▌  | 15/20 [00:01<00:00,  8.84it/s, eval_psnr=20.5, total_loss=0.0018, train_psnr=27.7]     Epoch 5:  80%|████████  | 16/20 [00:01<00:00,  8.84it/s, eval_psnr=20.5, total_loss=0.0018, train_psnr=27.7]    Epoch 5:  80%|████████  | 16/20 [00:01<00:00,  8.84it/s, eval_psnr=20.5, total_loss=0.0018, train_psnr=27.7]    Epoch 5:  80%|████████  | 16/20 [00:01<00:00,  8.84it/s, eval_psnr=20.5, total_loss=0.00182, train_psnr=27.7]    Epoch 5:  85%|████████▌ | 17/20 [00:01<00:00,  8.82it/s, eval_psnr=20.5, total_loss=0.00182, train_psnr=27.7]    Epoch 5:  85%|████████▌ | 17/20 [00:01<00:00,  8.82it/s, eval_psnr=20.5, total_loss=0.00182, train_psnr=27.7]    Epoch 5:  85%|████████▌ | 17/20 [00:02<00:00,  8.82it/s, eval_psnr=20.5, total_loss=0.00187, train_psnr=27.7]    Epoch 5:  90%|█████████ | 18/20 [00:02<00:00,  8.87it/s, eval_psnr=20.5, total_loss=0.00187, train_psnr=27.7]    Epoch 5:  90%|█████████ | 18/20 [00:02<00:00,  8.87it/s, eval_psnr=20.5, total_loss=0.00187, train_psnr=27.7]    Epoch 5:  90%|█████████ | 18/20 [00:02<00:00,  8.87it/s, eval_psnr=20.5, total_loss=0.0019, train_psnr=27.6]     Epoch 5:  95%|█████████▌| 19/20 [00:02<00:00,  8.87it/s, eval_psnr=20.5, total_loss=0.0019, train_psnr=27.6]    Epoch 5:  95%|█████████▌| 19/20 [00:02<00:00,  8.87it/s, eval_psnr=20.5, total_loss=0.0019, train_psnr=27.6]    Epoch 5:  95%|█████████▌| 19/20 [00:02<00:00,  8.87it/s, eval_psnr=20.5, total_loss=0.00191, train_psnr=27.6]    Epoch 5: 100%|██████████| 20/20 [00:02<00:00,  8.86it/s, eval_psnr=20.5, total_loss=0.00191, train_psnr=27.6]    Epoch 5: 100%|██████████| 20/20 [00:02<00:00,  8.82it/s, eval_psnr=20.5, total_loss=0.00191, train_psnr=27.6]
      0%|          | 0/20 [00:00<?, ?it/s]    Epoch 6:   0%|          | 0/20 [00:00<?, ?it/s]    Epoch 6:   0%|          | 0/20 [00:00<?, ?it/s, eval_psnr=20.6, total_loss=0.00136, train_psnr=29.1]    Epoch 6:   5%|▌         | 1/20 [00:00<00:02,  8.03it/s, eval_psnr=20.6, total_loss=0.00136, train_psnr=29.1]    Epoch 6:   5%|▌         | 1/20 [00:00<00:02,  8.03it/s, eval_psnr=20.6, total_loss=0.00136, train_psnr=29.1]    Epoch 6:   5%|▌         | 1/20 [00:00<00:02,  8.03it/s, eval_psnr=20.6, total_loss=0.00161, train_psnr=28.3]    Epoch 6:  10%|█         | 2/20 [00:00<00:02,  8.41it/s, eval_psnr=20.6, total_loss=0.00161, train_psnr=28.3]    Epoch 6:  10%|█         | 2/20 [00:00<00:02,  8.41it/s, eval_psnr=20.6, total_loss=0.00161, train_psnr=28.3]    Epoch 6:  10%|█         | 2/20 [00:00<00:02,  8.41it/s, eval_psnr=20.6, total_loss=0.00167, train_psnr=28]      Epoch 6:  15%|█▌        | 3/20 [00:00<00:01,  8.54it/s, eval_psnr=20.6, total_loss=0.00167, train_psnr=28]    Epoch 6:  15%|█▌        | 3/20 [00:00<00:01,  8.54it/s, eval_psnr=20.6, total_loss=0.00167, train_psnr=28]    Epoch 6:  15%|█▌        | 3/20 [00:00<00:01,  8.54it/s, eval_psnr=20.6, total_loss=0.00164, train_psnr=28.1]    Epoch 6:  20%|██        | 4/20 [00:00<00:01,  8.65it/s, eval_psnr=20.6, total_loss=0.00164, train_psnr=28.1]    Epoch 6:  20%|██        | 4/20 [00:00<00:01,  8.65it/s, eval_psnr=20.6, total_loss=0.00164, train_psnr=28.1]    Epoch 6:  20%|██        | 4/20 [00:00<00:01,  8.65it/s, eval_psnr=20.6, total_loss=0.00171, train_psnr=28.1]    Epoch 6:  25%|██▌       | 5/20 [00:00<00:01,  8.66it/s, eval_psnr=20.6, total_loss=0.00171, train_psnr=28.1]    Epoch 6:  25%|██▌       | 5/20 [00:00<00:01,  8.66it/s, eval_psnr=20.6, total_loss=0.00171, train_psnr=28.1]    Epoch 6:  25%|██▌       | 5/20 [00:00<00:01,  8.66it/s, eval_psnr=20.6, total_loss=0.0018, train_psnr=27.9]     Epoch 6:  30%|███       | 6/20 [00:00<00:01,  8.72it/s, eval_psnr=20.6, total_loss=0.0018, train_psnr=27.9]    Epoch 6:  30%|███       | 6/20 [00:00<00:01,  8.72it/s, eval_psnr=20.6, total_loss=0.0018, train_psnr=27.9]    Epoch 6:  30%|███       | 6/20 [00:00<00:01,  8.72it/s, eval_psnr=20.6, total_loss=0.00179, train_psnr=27.9]    Epoch 6:  35%|███▌      | 7/20 [00:00<00:01,  8.75it/s, eval_psnr=20.6, total_loss=0.00179, train_psnr=27.9]    Epoch 6:  35%|███▌      | 7/20 [00:00<00:01,  8.75it/s, eval_psnr=20.6, total_loss=0.00179, train_psnr=27.9]    Epoch 6:  35%|███▌      | 7/20 [00:00<00:01,  8.75it/s, eval_psnr=20.6, total_loss=0.00175, train_psnr=28]      Epoch 6:  40%|████      | 8/20 [00:00<00:01,  8.79it/s, eval_psnr=20.6, total_loss=0.00175, train_psnr=28]    Epoch 6:  40%|████      | 8/20 [00:00<00:01,  8.79it/s, eval_psnr=20.6, total_loss=0.00175, train_psnr=28]    Epoch 6:  40%|████      | 8/20 [00:01<00:01,  8.79it/s, eval_psnr=20.6, total_loss=0.00174, train_psnr=28]    Epoch 6:  45%|████▌     | 9/20 [00:01<00:01,  8.78it/s, eval_psnr=20.6, total_loss=0.00174, train_psnr=28]    Epoch 6:  45%|████▌     | 9/20 [00:01<00:01,  8.78it/s, eval_psnr=20.6, total_loss=0.00174, train_psnr=28]    Epoch 6:  45%|████▌     | 9/20 [00:01<00:01,  8.78it/s, eval_psnr=20.6, total_loss=0.00175, train_psnr=28]    Epoch 6:  50%|█████     | 10/20 [00:01<00:01,  8.57it/s, eval_psnr=20.6, total_loss=0.00175, train_psnr=28]    Epoch 6:  50%|█████     | 10/20 [00:01<00:01,  8.57it/s, eval_psnr=20.6, total_loss=0.00175, train_psnr=28]    Epoch 6:  50%|█████     | 10/20 [00:01<00:01,  8.57it/s, eval_psnr=20.6, total_loss=0.00177, train_psnr=28]    Epoch 6:  55%|█████▌    | 11/20 [00:01<00:01,  8.65it/s, eval_psnr=20.6, total_loss=0.00177, train_psnr=28]    Epoch 6:  55%|█████▌    | 11/20 [00:01<00:01,  8.65it/s, eval_psnr=20.6, total_loss=0.00177, train_psnr=28]    Epoch 6:  55%|█████▌    | 11/20 [00:01<00:01,  8.65it/s, eval_psnr=20.6, total_loss=0.00177, train_psnr=28]    Epoch 6:  60%|██████    | 12/20 [00:01<00:00,  8.73it/s, eval_psnr=20.6, total_loss=0.00177, train_psnr=28]    Epoch 6:  60%|██████    | 12/20 [00:01<00:00,  8.73it/s, eval_psnr=20.6, total_loss=0.00177, train_psnr=28]    Epoch 6:  60%|██████    | 12/20 [00:01<00:00,  8.73it/s, eval_psnr=20.6, total_loss=0.00175, train_psnr=28]    Epoch 6:  65%|██████▌   | 13/20 [00:01<00:00,  8.76it/s, eval_psnr=20.6, total_loss=0.00175, train_psnr=28]    Epoch 6:  65%|██████▌   | 13/20 [00:01<00:00,  8.76it/s, eval_psnr=20.6, total_loss=0.00175, train_psnr=28]    Epoch 6:  65%|██████▌   | 13/20 [00:01<00:00,  8.76it/s, eval_psnr=20.6, total_loss=0.00184, train_psnr=27.9]    Epoch 6:  70%|███████   | 14/20 [00:01<00:00,  8.79it/s, eval_psnr=20.6, total_loss=0.00184, train_psnr=27.9]    Epoch 6:  70%|███████   | 14/20 [00:01<00:00,  8.79it/s, eval_psnr=20.6, total_loss=0.00184, train_psnr=27.9]    Epoch 6:  70%|███████   | 14/20 [00:01<00:00,  8.79it/s, eval_psnr=20.6, total_loss=0.00183, train_psnr=27.9]    Epoch 6:  75%|███████▌  | 15/20 [00:01<00:00,  8.81it/s, eval_psnr=20.6, total_loss=0.00183, train_psnr=27.9]    Epoch 6:  75%|███████▌  | 15/20 [00:01<00:00,  8.81it/s, eval_psnr=20.6, total_loss=0.00183, train_psnr=27.9]    Epoch 6:  75%|███████▌  | 15/20 [00:01<00:00,  8.81it/s, eval_psnr=20.6, total_loss=0.0018, train_psnr=28]       Epoch 6:  80%|████████  | 16/20 [00:01<00:00,  8.83it/s, eval_psnr=20.6, total_loss=0.0018, train_psnr=28]    Epoch 6:  80%|████████  | 16/20 [00:01<00:00,  8.83it/s, eval_psnr=20.6, total_loss=0.0018, train_psnr=28]    Epoch 6:  80%|████████  | 16/20 [00:01<00:00,  8.83it/s, eval_psnr=20.6, total_loss=0.00181, train_psnr=27.9]    Epoch 6:  85%|████████▌ | 17/20 [00:01<00:00,  8.85it/s, eval_psnr=20.6, total_loss=0.00181, train_psnr=27.9]    Epoch 6:  85%|████████▌ | 17/20 [00:01<00:00,  8.85it/s, eval_psnr=20.6, total_loss=0.00181, train_psnr=27.9]    Epoch 6:  85%|████████▌ | 17/20 [00:02<00:00,  8.85it/s, eval_psnr=20.6, total_loss=0.00183, train_psnr=27.9]    Epoch 6:  90%|█████████ | 18/20 [00:02<00:00,  8.85it/s, eval_psnr=20.6, total_loss=0.00183, train_psnr=27.9]    Epoch 6:  90%|█████████ | 18/20 [00:02<00:00,  8.85it/s, eval_psnr=20.6, total_loss=0.00183, train_psnr=27.9]    Epoch 6:  90%|█████████ | 18/20 [00:02<00:00,  8.85it/s, eval_psnr=20.6, total_loss=0.00186, train_psnr=27.9]    Epoch 6:  95%|█████████▌| 19/20 [00:02<00:00,  8.65it/s, eval_psnr=20.6, total_loss=0.00186, train_psnr=27.9]    Epoch 6:  95%|█████████▌| 19/20 [00:02<00:00,  8.65it/s, eval_psnr=20.6, total_loss=0.00186, train_psnr=27.9]    Epoch 6:  95%|█████████▌| 19/20 [00:02<00:00,  8.65it/s, eval_psnr=20.6, total_loss=0.00185, train_psnr=27.9]    Epoch 6: 100%|██████████| 20/20 [00:02<00:00,  8.70it/s, eval_psnr=20.6, total_loss=0.00185, train_psnr=27.9]    Epoch 6: 100%|██████████| 20/20 [00:02<00:00,  8.71it/s, eval_psnr=20.6, total_loss=0.00185, train_psnr=27.9]
      0%|          | 0/20 [00:00<?, ?it/s]    Epoch 7:   0%|          | 0/20 [00:00<?, ?it/s]    Epoch 7:   0%|          | 0/20 [00:00<?, ?it/s, eval_psnr=20.7, total_loss=0.00169, train_psnr=28]    Epoch 7:   5%|▌         | 1/20 [00:00<00:02,  8.96it/s, eval_psnr=20.7, total_loss=0.00169, train_psnr=28]    Epoch 7:   5%|▌         | 1/20 [00:00<00:02,  8.96it/s, eval_psnr=20.7, total_loss=0.00169, train_psnr=28]    Epoch 7:   5%|▌         | 1/20 [00:00<00:02,  8.96it/s, eval_psnr=20.7, total_loss=0.00201, train_psnr=27.4]    Epoch 7:  10%|█         | 2/20 [00:00<00:02,  8.86it/s, eval_psnr=20.7, total_loss=0.00201, train_psnr=27.4]    Epoch 7:  10%|█         | 2/20 [00:00<00:02,  8.86it/s, eval_psnr=20.7, total_loss=0.00201, train_psnr=27.4]    Epoch 7:  10%|█         | 2/20 [00:00<00:02,  8.86it/s, eval_psnr=20.7, total_loss=0.0017, train_psnr=28.2]     Epoch 7:  15%|█▌        | 3/20 [00:00<00:01,  8.94it/s, eval_psnr=20.7, total_loss=0.0017, train_psnr=28.2]    Epoch 7:  15%|█▌        | 3/20 [00:00<00:01,  8.94it/s, eval_psnr=20.7, total_loss=0.0017, train_psnr=28.2]    Epoch 7:  15%|█▌        | 3/20 [00:00<00:01,  8.94it/s, eval_psnr=20.7, total_loss=0.0017, train_psnr=28.2]    Epoch 7:  20%|██        | 4/20 [00:00<00:01,  8.92it/s, eval_psnr=20.7, total_loss=0.0017, train_psnr=28.2]    Epoch 7:  20%|██        | 4/20 [00:00<00:01,  8.92it/s, eval_psnr=20.7, total_loss=0.0017, train_psnr=28.2]    Epoch 7:  20%|██        | 4/20 [00:00<00:01,  8.92it/s, eval_psnr=20.7, total_loss=0.00178, train_psnr=28]     Epoch 7:  25%|██▌       | 5/20 [00:00<00:01,  8.89it/s, eval_psnr=20.7, total_loss=0.00178, train_psnr=28]    Epoch 7:  25%|██▌       | 5/20 [00:00<00:01,  8.89it/s, eval_psnr=20.7, total_loss=0.00178, train_psnr=28]    Epoch 7:  25%|██▌       | 5/20 [00:00<00:01,  8.89it/s, eval_psnr=20.7, total_loss=0.00185, train_psnr=27.8]    Epoch 7:  30%|███       | 6/20 [00:00<00:01,  8.89it/s, eval_psnr=20.7, total_loss=0.00185, train_psnr=27.8]    Epoch 7:  30%|███       | 6/20 [00:00<00:01,  8.89it/s, eval_psnr=20.7, total_loss=0.00185, train_psnr=27.8]    Epoch 7:  30%|███       | 6/20 [00:00<00:01,  8.89it/s, eval_psnr=20.7, total_loss=0.00188, train_psnr=27.7]    Epoch 7:  35%|███▌      | 7/20 [00:00<00:01,  8.85it/s, eval_psnr=20.7, total_loss=0.00188, train_psnr=27.7]    Epoch 7:  35%|███▌      | 7/20 [00:00<00:01,  8.85it/s, eval_psnr=20.7, total_loss=0.00188, train_psnr=27.7]    Epoch 7:  35%|███▌      | 7/20 [00:00<00:01,  8.85it/s, eval_psnr=20.7, total_loss=0.00184, train_psnr=27.8]    Epoch 7:  40%|████      | 8/20 [00:00<00:01,  8.66it/s, eval_psnr=20.7, total_loss=0.00184, train_psnr=27.8]    Epoch 7:  40%|████      | 8/20 [00:00<00:01,  8.66it/s, eval_psnr=20.7, total_loss=0.00184, train_psnr=27.8]    Epoch 7:  40%|████      | 8/20 [00:01<00:01,  8.66it/s, eval_psnr=20.7, total_loss=0.00191, train_psnr=27.7]    Epoch 7:  45%|████▌     | 9/20 [00:01<00:01,  8.70it/s, eval_psnr=20.7, total_loss=0.00191, train_psnr=27.7]    Epoch 7:  45%|████▌     | 9/20 [00:01<00:01,  8.70it/s, eval_psnr=20.7, total_loss=0.00191, train_psnr=27.7]    Epoch 7:  45%|████▌     | 9/20 [00:01<00:01,  8.70it/s, eval_psnr=20.7, total_loss=0.00186, train_psnr=27.8]    Epoch 7:  50%|█████     | 10/20 [00:01<00:01,  8.75it/s, eval_psnr=20.7, total_loss=0.00186, train_psnr=27.8]    Epoch 7:  50%|█████     | 10/20 [00:01<00:01,  8.75it/s, eval_psnr=20.7, total_loss=0.00186, train_psnr=27.8]    Epoch 7:  50%|█████     | 10/20 [00:01<00:01,  8.75it/s, eval_psnr=20.7, total_loss=0.00186, train_psnr=27.8]    Epoch 7:  55%|█████▌    | 11/20 [00:01<00:01,  8.75it/s, eval_psnr=20.7, total_loss=0.00186, train_psnr=27.8]    Epoch 7:  55%|█████▌    | 11/20 [00:01<00:01,  8.75it/s, eval_psnr=20.7, total_loss=0.00186, train_psnr=27.8]    Epoch 7:  55%|█████▌    | 11/20 [00:01<00:01,  8.75it/s, eval_psnr=20.7, total_loss=0.00183, train_psnr=27.8]    Epoch 7:  60%|██████    | 12/20 [00:01<00:00,  8.79it/s, eval_psnr=20.7, total_loss=0.00183, train_psnr=27.8]    Epoch 7:  60%|██████    | 12/20 [00:01<00:00,  8.79it/s, eval_psnr=20.7, total_loss=0.00183, train_psnr=27.8]    Epoch 7:  60%|██████    | 12/20 [00:01<00:00,  8.79it/s, eval_psnr=20.7, total_loss=0.00178, train_psnr=27.9]    Epoch 7:  65%|██████▌   | 13/20 [00:01<00:00,  8.82it/s, eval_psnr=20.7, total_loss=0.00178, train_psnr=27.9]    Epoch 7:  65%|██████▌   | 13/20 [00:01<00:00,  8.82it/s, eval_psnr=20.7, total_loss=0.00178, train_psnr=27.9]    Epoch 7:  65%|██████▌   | 13/20 [00:01<00:00,  8.82it/s, eval_psnr=20.7, total_loss=0.00176, train_psnr=28]      Epoch 7:  70%|███████   | 14/20 [00:01<00:00,  8.81it/s, eval_psnr=20.7, total_loss=0.00176, train_psnr=28]    Epoch 7:  70%|███████   | 14/20 [00:01<00:00,  8.81it/s, eval_psnr=20.7, total_loss=0.00176, train_psnr=28]    Epoch 7:  70%|███████   | 14/20 [00:01<00:00,  8.81it/s, eval_psnr=20.7, total_loss=0.00177, train_psnr=27.9]    Epoch 7:  75%|███████▌  | 15/20 [00:01<00:00,  8.77it/s, eval_psnr=20.7, total_loss=0.00177, train_psnr=27.9]    Epoch 7:  75%|███████▌  | 15/20 [00:01<00:00,  8.77it/s, eval_psnr=20.7, total_loss=0.00177, train_psnr=27.9]    Epoch 7:  75%|███████▌  | 15/20 [00:01<00:00,  8.77it/s, eval_psnr=20.7, total_loss=0.00179, train_psnr=27.9]    Epoch 7:  80%|████████  | 16/20 [00:01<00:00,  8.78it/s, eval_psnr=20.7, total_loss=0.00179, train_psnr=27.9]    Epoch 7:  80%|████████  | 16/20 [00:01<00:00,  8.78it/s, eval_psnr=20.7, total_loss=0.00179, train_psnr=27.9]    Epoch 7:  80%|████████  | 16/20 [00:01<00:00,  8.78it/s, eval_psnr=20.7, total_loss=0.00178, train_psnr=27.9]    Epoch 7:  85%|████████▌ | 17/20 [00:01<00:00,  8.76it/s, eval_psnr=20.7, total_loss=0.00178, train_psnr=27.9]    Epoch 7:  85%|████████▌ | 17/20 [00:01<00:00,  8.76it/s, eval_psnr=20.7, total_loss=0.00178, train_psnr=27.9]    Epoch 7:  85%|████████▌ | 17/20 [00:02<00:00,  8.76it/s, eval_psnr=20.7, total_loss=0.00178, train_psnr=27.9]    Epoch 7:  90%|█████████ | 18/20 [00:02<00:00,  8.79it/s, eval_psnr=20.7, total_loss=0.00178, train_psnr=27.9]    Epoch 7:  90%|█████████ | 18/20 [00:02<00:00,  8.79it/s, eval_psnr=20.7, total_loss=0.00178, train_psnr=27.9]    Epoch 7:  90%|█████████ | 18/20 [00:02<00:00,  8.79it/s, eval_psnr=20.7, total_loss=0.00176, train_psnr=28]      Epoch 7:  95%|█████████▌| 19/20 [00:02<00:00,  8.79it/s, eval_psnr=20.7, total_loss=0.00176, train_psnr=28]    Epoch 7:  95%|█████████▌| 19/20 [00:02<00:00,  8.79it/s, eval_psnr=20.7, total_loss=0.00176, train_psnr=28]    Epoch 7:  95%|█████████▌| 19/20 [00:02<00:00,  8.79it/s, eval_psnr=20.7, total_loss=0.0018, train_psnr=27.9]    Epoch 7: 100%|██████████| 20/20 [00:02<00:00,  8.79it/s, eval_psnr=20.7, total_loss=0.0018, train_psnr=27.9]    Epoch 7: 100%|██████████| 20/20 [00:02<00:00,  8.80it/s, eval_psnr=20.7, total_loss=0.0018, train_psnr=27.9]
      0%|          | 0/20 [00:00<?, ?it/s]    Epoch 8:   0%|          | 0/20 [00:00<?, ?it/s]    Epoch 8:   0%|          | 0/20 [00:00<?, ?it/s, eval_psnr=20.8, total_loss=0.00185, train_psnr=27.8]    Epoch 8:   5%|▌         | 1/20 [00:00<00:02,  8.96it/s, eval_psnr=20.8, total_loss=0.00185, train_psnr=27.8]    Epoch 8:   5%|▌         | 1/20 [00:00<00:02,  8.96it/s, eval_psnr=20.8, total_loss=0.00185, train_psnr=27.8]    Epoch 8:   5%|▌         | 1/20 [00:00<00:02,  8.96it/s, eval_psnr=20.8, total_loss=0.00154, train_psnr=28.5]    Epoch 8:  10%|█         | 2/20 [00:00<00:02,  8.94it/s, eval_psnr=20.8, total_loss=0.00154, train_psnr=28.5]    Epoch 8:  10%|█         | 2/20 [00:00<00:02,  8.94it/s, eval_psnr=20.8, total_loss=0.00154, train_psnr=28.5]    Epoch 8:  10%|█         | 2/20 [00:00<00:02,  8.94it/s, eval_psnr=20.8, total_loss=0.00164, train_psnr=28.3]    Epoch 8:  15%|█▌        | 3/20 [00:00<00:01,  8.85it/s, eval_psnr=20.8, total_loss=0.00164, train_psnr=28.3]    Epoch 8:  15%|█▌        | 3/20 [00:00<00:01,  8.85it/s, eval_psnr=20.8, total_loss=0.00164, train_psnr=28.3]    Epoch 8:  15%|█▌        | 3/20 [00:00<00:01,  8.85it/s, eval_psnr=20.8, total_loss=0.00166, train_psnr=28.3]    Epoch 8:  20%|██        | 4/20 [00:00<00:01,  8.87it/s, eval_psnr=20.8, total_loss=0.00166, train_psnr=28.3]    Epoch 8:  20%|██        | 4/20 [00:00<00:01,  8.87it/s, eval_psnr=20.8, total_loss=0.00166, train_psnr=28.3]    Epoch 8:  20%|██        | 4/20 [00:00<00:01,  8.87it/s, eval_psnr=20.8, total_loss=0.0016, train_psnr=28.4]     Epoch 8:  25%|██▌       | 5/20 [00:00<00:01,  8.91it/s, eval_psnr=20.8, total_loss=0.0016, train_psnr=28.4]    Epoch 8:  25%|██▌       | 5/20 [00:00<00:01,  8.91it/s, eval_psnr=20.8, total_loss=0.0016, train_psnr=28.4]    Epoch 8:  25%|██▌       | 5/20 [00:00<00:01,  8.91it/s, eval_psnr=20.8, total_loss=0.0016, train_psnr=28.4]    Epoch 8:  30%|███       | 6/20 [00:00<00:01,  8.79it/s, eval_psnr=20.8, total_loss=0.0016, train_psnr=28.4]    Epoch 8:  30%|███       | 6/20 [00:00<00:01,  8.79it/s, eval_psnr=20.8, total_loss=0.0016, train_psnr=28.4]    Epoch 8:  30%|███       | 6/20 [00:00<00:01,  8.79it/s, eval_psnr=20.8, total_loss=0.00164, train_psnr=28.2]    Epoch 8:  35%|███▌      | 7/20 [00:00<00:01,  8.81it/s, eval_psnr=20.8, total_loss=0.00164, train_psnr=28.2]    Epoch 8:  35%|███▌      | 7/20 [00:00<00:01,  8.81it/s, eval_psnr=20.8, total_loss=0.00164, train_psnr=28.2]    Epoch 8:  35%|███▌      | 7/20 [00:00<00:01,  8.81it/s, eval_psnr=20.8, total_loss=0.00169, train_psnr=28.1]    Epoch 8:  40%|████      | 8/20 [00:00<00:01,  8.82it/s, eval_psnr=20.8, total_loss=0.00169, train_psnr=28.1]    Epoch 8:  40%|████      | 8/20 [00:00<00:01,  8.82it/s, eval_psnr=20.8, total_loss=0.00169, train_psnr=28.1]    Epoch 8:  40%|████      | 8/20 [00:01<00:01,  8.82it/s, eval_psnr=20.8, total_loss=0.00167, train_psnr=28.1]    Epoch 8:  45%|████▌     | 9/20 [00:01<00:01,  8.87it/s, eval_psnr=20.8, total_loss=0.00167, train_psnr=28.1]    Epoch 8:  45%|████▌     | 9/20 [00:01<00:01,  8.87it/s, eval_psnr=20.8, total_loss=0.00167, train_psnr=28.1]    Epoch 8:  45%|████▌     | 9/20 [00:01<00:01,  8.87it/s, eval_psnr=20.8, total_loss=0.00174, train_psnr=28]      Epoch 8:  50%|█████     | 10/20 [00:01<00:01,  8.83it/s, eval_psnr=20.8, total_loss=0.00174, train_psnr=28]    Epoch 8:  50%|█████     | 10/20 [00:01<00:01,  8.83it/s, eval_psnr=20.8, total_loss=0.00174, train_psnr=28]    Epoch 8:  50%|█████     | 10/20 [00:01<00:01,  8.83it/s, eval_psnr=20.8, total_loss=0.00173, train_psnr=28]    Epoch 8:  55%|█████▌    | 11/20 [00:01<00:01,  8.84it/s, eval_psnr=20.8, total_loss=0.00173, train_psnr=28]    Epoch 8:  55%|█████▌    | 11/20 [00:01<00:01,  8.84it/s, eval_psnr=20.8, total_loss=0.00173, train_psnr=28]    Epoch 8:  55%|█████▌    | 11/20 [00:01<00:01,  8.84it/s, eval_psnr=20.8, total_loss=0.00176, train_psnr=27.9]    Epoch 8:  60%|██████    | 12/20 [00:01<00:00,  8.86it/s, eval_psnr=20.8, total_loss=0.00176, train_psnr=27.9]    Epoch 8:  60%|██████    | 12/20 [00:01<00:00,  8.86it/s, eval_psnr=20.8, total_loss=0.00176, train_psnr=27.9]    Epoch 8:  60%|██████    | 12/20 [00:01<00:00,  8.86it/s, eval_psnr=20.8, total_loss=0.00175, train_psnr=27.9]    Epoch 8:  65%|██████▌   | 13/20 [00:01<00:00,  8.90it/s, eval_psnr=20.8, total_loss=0.00175, train_psnr=27.9]    Epoch 8:  65%|██████▌   | 13/20 [00:01<00:00,  8.90it/s, eval_psnr=20.8, total_loss=0.00175, train_psnr=27.9]    Epoch 8:  65%|██████▌   | 13/20 [00:01<00:00,  8.90it/s, eval_psnr=20.8, total_loss=0.00178, train_psnr=27.9]    Epoch 8:  70%|███████   | 14/20 [00:01<00:00,  8.87it/s, eval_psnr=20.8, total_loss=0.00178, train_psnr=27.9]    Epoch 8:  70%|███████   | 14/20 [00:01<00:00,  8.87it/s, eval_psnr=20.8, total_loss=0.00178, train_psnr=27.9]    Epoch 8:  70%|███████   | 14/20 [00:01<00:00,  8.87it/s, eval_psnr=20.8, total_loss=0.00179, train_psnr=27.8]    Epoch 8:  75%|███████▌  | 15/20 [00:01<00:00,  8.76it/s, eval_psnr=20.8, total_loss=0.00179, train_psnr=27.8]    Epoch 8:  75%|███████▌  | 15/20 [00:01<00:00,  8.76it/s, eval_psnr=20.8, total_loss=0.00179, train_psnr=27.8]    Epoch 8:  75%|███████▌  | 15/20 [00:01<00:00,  8.76it/s, eval_psnr=20.8, total_loss=0.00178, train_psnr=27.9]    Epoch 8:  80%|████████  | 16/20 [00:01<00:00,  8.83it/s, eval_psnr=20.8, total_loss=0.00178, train_psnr=27.9]    Epoch 8:  80%|████████  | 16/20 [00:01<00:00,  8.83it/s, eval_psnr=20.8, total_loss=0.00178, train_psnr=27.9]    Epoch 8:  80%|████████  | 16/20 [00:01<00:00,  8.83it/s, eval_psnr=20.8, total_loss=0.00178, train_psnr=27.8]    Epoch 8:  85%|████████▌ | 17/20 [00:01<00:00,  8.76it/s, eval_psnr=20.8, total_loss=0.00178, train_psnr=27.8]    Epoch 8:  85%|████████▌ | 17/20 [00:01<00:00,  8.76it/s, eval_psnr=20.8, total_loss=0.00178, train_psnr=27.8]    Epoch 8:  85%|████████▌ | 17/20 [00:02<00:00,  8.76it/s, eval_psnr=20.8, total_loss=0.00179, train_psnr=27.8]    Epoch 8:  90%|█████████ | 18/20 [00:02<00:00,  8.73it/s, eval_psnr=20.8, total_loss=0.00179, train_psnr=27.8]    Epoch 8:  90%|█████████ | 18/20 [00:02<00:00,  8.73it/s, eval_psnr=20.8, total_loss=0.00179, train_psnr=27.8]    Epoch 8:  90%|█████████ | 18/20 [00:02<00:00,  8.73it/s, eval_psnr=20.8, total_loss=0.00188, train_psnr=27.7]    Epoch 8:  95%|█████████▌| 19/20 [00:02<00:00,  8.70it/s, eval_psnr=20.8, total_loss=0.00188, train_psnr=27.7]    Epoch 8:  95%|█████████▌| 19/20 [00:02<00:00,  8.70it/s, eval_psnr=20.8, total_loss=0.00188, train_psnr=27.7]    Epoch 8:  95%|█████████▌| 19/20 [00:02<00:00,  8.70it/s, eval_psnr=20.8, total_loss=0.00188, train_psnr=27.7]    Epoch 8: 100%|██████████| 20/20 [00:02<00:00,  8.69it/s, eval_psnr=20.8, total_loss=0.00188, train_psnr=27.7]    Epoch 8: 100%|██████████| 20/20 [00:02<00:00,  8.80it/s, eval_psnr=20.8, total_loss=0.00188, train_psnr=27.7]
      0%|          | 0/20 [00:00<?, ?it/s]    Epoch 9:   0%|          | 0/20 [00:00<?, ?it/s]    Epoch 9:   0%|          | 0/20 [00:00<?, ?it/s, eval_psnr=20.9, total_loss=0.00151, train_psnr=28.3]    Epoch 9:   5%|▌         | 1/20 [00:00<00:02,  8.63it/s, eval_psnr=20.9, total_loss=0.00151, train_psnr=28.3]    Epoch 9:   5%|▌         | 1/20 [00:00<00:02,  8.63it/s, eval_psnr=20.9, total_loss=0.00151, train_psnr=28.3]    Epoch 9:   5%|▌         | 1/20 [00:00<00:02,  8.63it/s, eval_psnr=20.9, total_loss=0.00147, train_psnr=28.4]    Epoch 9:  10%|█         | 2/20 [00:00<00:02,  8.64it/s, eval_psnr=20.9, total_loss=0.00147, train_psnr=28.4]    Epoch 9:  10%|█         | 2/20 [00:00<00:02,  8.64it/s, eval_psnr=20.9, total_loss=0.00147, train_psnr=28.4]    Epoch 9:  10%|█         | 2/20 [00:00<00:02,  8.64it/s, eval_psnr=20.9, total_loss=0.00173, train_psnr=27.8]    Epoch 9:  15%|█▌        | 3/20 [00:00<00:01,  8.67it/s, eval_psnr=20.9, total_loss=0.00173, train_psnr=27.8]    Epoch 9:  15%|█▌        | 3/20 [00:00<00:01,  8.67it/s, eval_psnr=20.9, total_loss=0.00173, train_psnr=27.8]    Epoch 9:  15%|█▌        | 3/20 [00:00<00:01,  8.67it/s, eval_psnr=20.9, total_loss=0.00177, train_psnr=27.8]    Epoch 9:  20%|██        | 4/20 [00:00<00:01,  8.57it/s, eval_psnr=20.9, total_loss=0.00177, train_psnr=27.8]    Epoch 9:  20%|██        | 4/20 [00:00<00:01,  8.57it/s, eval_psnr=20.9, total_loss=0.00177, train_psnr=27.8]    Epoch 9:  20%|██        | 4/20 [00:00<00:01,  8.57it/s, eval_psnr=20.9, total_loss=0.00168, train_psnr=28]      Epoch 9:  25%|██▌       | 5/20 [00:00<00:01,  8.63it/s, eval_psnr=20.9, total_loss=0.00168, train_psnr=28]    Epoch 9:  25%|██▌       | 5/20 [00:00<00:01,  8.63it/s, eval_psnr=20.9, total_loss=0.00168, train_psnr=28]    Epoch 9:  25%|██▌       | 5/20 [00:00<00:01,  8.63it/s, eval_psnr=20.9, total_loss=0.00161, train_psnr=28.2]    Epoch 9:  30%|███       | 6/20 [00:00<00:01,  8.68it/s, eval_psnr=20.9, total_loss=0.00161, train_psnr=28.2]    Epoch 9:  30%|███       | 6/20 [00:00<00:01,  8.68it/s, eval_psnr=20.9, total_loss=0.00161, train_psnr=28.2]    Epoch 9:  30%|███       | 6/20 [00:00<00:01,  8.68it/s, eval_psnr=20.9, total_loss=0.00154, train_psnr=28.5]    Epoch 9:  35%|███▌      | 7/20 [00:00<00:01,  8.74it/s, eval_psnr=20.9, total_loss=0.00154, train_psnr=28.5]    Epoch 9:  35%|███▌      | 7/20 [00:00<00:01,  8.74it/s, eval_psnr=20.9, total_loss=0.00154, train_psnr=28.5]    Epoch 9:  35%|███▌      | 7/20 [00:00<00:01,  8.74it/s, eval_psnr=20.9, total_loss=0.0016, train_psnr=28.3]     Epoch 9:  40%|████      | 8/20 [00:00<00:01,  8.73it/s, eval_psnr=20.9, total_loss=0.0016, train_psnr=28.3]    Epoch 9:  40%|████      | 8/20 [00:00<00:01,  8.73it/s, eval_psnr=20.9, total_loss=0.0016, train_psnr=28.3]    Epoch 9:  40%|████      | 8/20 [00:01<00:01,  8.73it/s, eval_psnr=20.9, total_loss=0.00157, train_psnr=28.4]    Epoch 9:  45%|████▌     | 9/20 [00:01<00:01,  8.70it/s, eval_psnr=20.9, total_loss=0.00157, train_psnr=28.4]    Epoch 9:  45%|████▌     | 9/20 [00:01<00:01,  8.70it/s, eval_psnr=20.9, total_loss=0.00157, train_psnr=28.4]    Epoch 9:  45%|████▌     | 9/20 [00:01<00:01,  8.70it/s, eval_psnr=20.9, total_loss=0.00168, train_psnr=28.2]    Epoch 9:  50%|█████     | 10/20 [00:01<00:01,  8.68it/s, eval_psnr=20.9, total_loss=0.00168, train_psnr=28.2]    Epoch 9:  50%|█████     | 10/20 [00:01<00:01,  8.68it/s, eval_psnr=20.9, total_loss=0.00168, train_psnr=28.2]    Epoch 9:  50%|█████     | 10/20 [00:01<00:01,  8.68it/s, eval_psnr=20.9, total_loss=0.00174, train_psnr=28]      Epoch 9:  55%|█████▌    | 11/20 [00:01<00:01,  8.70it/s, eval_psnr=20.9, total_loss=0.00174, train_psnr=28]    Epoch 9:  55%|█████▌    | 11/20 [00:01<00:01,  8.70it/s, eval_psnr=20.9, total_loss=0.00174, train_psnr=28]    Epoch 9:  55%|█████▌    | 11/20 [00:01<00:01,  8.70it/s, eval_psnr=20.9, total_loss=0.00174, train_psnr=28]    Epoch 9:  60%|██████    | 12/20 [00:01<00:00,  8.69it/s, eval_psnr=20.9, total_loss=0.00174, train_psnr=28]    Epoch 9:  60%|██████    | 12/20 [00:01<00:00,  8.69it/s, eval_psnr=20.9, total_loss=0.00174, train_psnr=28]    Epoch 9:  60%|██████    | 12/20 [00:01<00:00,  8.69it/s, eval_psnr=20.9, total_loss=0.00172, train_psnr=28]    Epoch 9:  65%|██████▌   | 13/20 [00:01<00:00,  8.49it/s, eval_psnr=20.9, total_loss=0.00172, train_psnr=28]    Epoch 9:  65%|██████▌   | 13/20 [00:01<00:00,  8.49it/s, eval_psnr=20.9, total_loss=0.00172, train_psnr=28]    Epoch 9:  65%|██████▌   | 13/20 [00:01<00:00,  8.49it/s, eval_psnr=20.9, total_loss=0.00173, train_psnr=28]    Epoch 9:  70%|███████   | 14/20 [00:01<00:00,  8.55it/s, eval_psnr=20.9, total_loss=0.00173, train_psnr=28]    Epoch 9:  70%|███████   | 14/20 [00:01<00:00,  8.55it/s, eval_psnr=20.9, total_loss=0.00173, train_psnr=28]    Epoch 9:  70%|███████   | 14/20 [00:01<00:00,  8.55it/s, eval_psnr=20.9, total_loss=0.00173, train_psnr=28]    Epoch 9:  75%|███████▌  | 15/20 [00:01<00:00,  8.61it/s, eval_psnr=20.9, total_loss=0.00173, train_psnr=28]    Epoch 9:  75%|███████▌  | 15/20 [00:01<00:00,  8.61it/s, eval_psnr=20.9, total_loss=0.00173, train_psnr=28]    Epoch 9:  75%|███████▌  | 15/20 [00:01<00:00,  8.61it/s, eval_psnr=20.9, total_loss=0.00172, train_psnr=28]    Epoch 9:  80%|████████  | 16/20 [00:01<00:00,  8.65it/s, eval_psnr=20.9, total_loss=0.00172, train_psnr=28]    Epoch 9:  80%|████████  | 16/20 [00:01<00:00,  8.65it/s, eval_psnr=20.9, total_loss=0.00172, train_psnr=28]    Epoch 9:  80%|████████  | 16/20 [00:01<00:00,  8.65it/s, eval_psnr=20.9, total_loss=0.00171, train_psnr=28]    Epoch 9:  85%|████████▌ | 17/20 [00:01<00:00,  8.70it/s, eval_psnr=20.9, total_loss=0.00171, train_psnr=28]    Epoch 9:  85%|████████▌ | 17/20 [00:01<00:00,  8.70it/s, eval_psnr=20.9, total_loss=0.00171, train_psnr=28]    Epoch 9:  85%|████████▌ | 17/20 [00:02<00:00,  8.70it/s, eval_psnr=20.9, total_loss=0.00171, train_psnr=28]    Epoch 9:  90%|█████████ | 18/20 [00:02<00:00,  8.73it/s, eval_psnr=20.9, total_loss=0.00171, train_psnr=28]    Epoch 9:  90%|█████████ | 18/20 [00:02<00:00,  8.73it/s, eval_psnr=20.9, total_loss=0.00171, train_psnr=28]    Epoch 9:  90%|█████████ | 18/20 [00:02<00:00,  8.73it/s, eval_psnr=20.9, total_loss=0.00174, train_psnr=28]    Epoch 9:  95%|█████████▌| 19/20 [00:02<00:00,  8.75it/s, eval_psnr=20.9, total_loss=0.00174, train_psnr=28]    Epoch 9:  95%|█████████▌| 19/20 [00:02<00:00,  8.75it/s, eval_psnr=20.9, total_loss=0.00174, train_psnr=28]    Epoch 9:  95%|█████████▌| 19/20 [00:02<00:00,  8.75it/s, eval_psnr=20.9, total_loss=0.00175, train_psnr=27.9]    Epoch 9: 100%|██████████| 20/20 [00:02<00:00,  8.76it/s, eval_psnr=20.9, total_loss=0.00175, train_psnr=27.9]    Epoch 9: 100%|██████████| 20/20 [00:02<00:00,  8.68it/s, eval_psnr=20.9, total_loss=0.00175, train_psnr=27.9]
      0%|          | 0/20 [00:00<?, ?it/s]    Epoch 10:   0%|          | 0/20 [00:00<?, ?it/s]    Epoch 10:   0%|          | 0/20 [00:00<?, ?it/s, eval_psnr=21, total_loss=0.00149, train_psnr=28.6]    Epoch 10:   5%|▌         | 1/20 [00:00<00:02,  8.79it/s, eval_psnr=21, total_loss=0.00149, train_psnr=28.6]    Epoch 10:   5%|▌         | 1/20 [00:00<00:02,  8.79it/s, eval_psnr=21, total_loss=0.00149, train_psnr=28.6]    Epoch 10:   5%|▌         | 1/20 [00:00<00:02,  8.79it/s, eval_psnr=21, total_loss=0.00183, train_psnr=28.3]    Epoch 10:  10%|█         | 2/20 [00:00<00:02,  8.68it/s, eval_psnr=21, total_loss=0.00183, train_psnr=28.3]    Epoch 10:  10%|█         | 2/20 [00:00<00:02,  8.68it/s, eval_psnr=21, total_loss=0.00183, train_psnr=28.3]    Epoch 10:  10%|█         | 2/20 [00:00<00:02,  8.68it/s, eval_psnr=21, total_loss=0.00179, train_psnr=28.2]    Epoch 10:  15%|█▌        | 3/20 [00:00<00:01,  8.70it/s, eval_psnr=21, total_loss=0.00179, train_psnr=28.2]    Epoch 10:  15%|█▌        | 3/20 [00:00<00:01,  8.70it/s, eval_psnr=21, total_loss=0.00179, train_psnr=28.2]    Epoch 10:  15%|█▌        | 3/20 [00:00<00:01,  8.70it/s, eval_psnr=21, total_loss=0.00196, train_psnr=27.8]    Epoch 10:  20%|██        | 4/20 [00:00<00:01,  8.73it/s, eval_psnr=21, total_loss=0.00196, train_psnr=27.8]    Epoch 10:  20%|██        | 4/20 [00:00<00:01,  8.73it/s, eval_psnr=21, total_loss=0.00196, train_psnr=27.8]    Epoch 10:  20%|██        | 4/20 [00:00<00:01,  8.73it/s, eval_psnr=21, total_loss=0.00191, train_psnr=27.8]    Epoch 10:  25%|██▌       | 5/20 [00:00<00:01,  8.73it/s, eval_psnr=21, total_loss=0.00191, train_psnr=27.8]    Epoch 10:  25%|██▌       | 5/20 [00:00<00:01,  8.73it/s, eval_psnr=21, total_loss=0.00191, train_psnr=27.8]    Epoch 10:  25%|██▌       | 5/20 [00:00<00:01,  8.73it/s, eval_psnr=21, total_loss=0.00186, train_psnr=27.8]    Epoch 10:  30%|███       | 6/20 [00:00<00:01,  8.77it/s, eval_psnr=21, total_loss=0.00186, train_psnr=27.8]    Epoch 10:  30%|███       | 6/20 [00:00<00:01,  8.77it/s, eval_psnr=21, total_loss=0.00186, train_psnr=27.8]    Epoch 10:  30%|███       | 6/20 [00:00<00:01,  8.77it/s, eval_psnr=21, total_loss=0.00199, train_psnr=27.7]    Epoch 10:  35%|███▌      | 7/20 [00:00<00:01,  8.81it/s, eval_psnr=21, total_loss=0.00199, train_psnr=27.7]    Epoch 10:  35%|███▌      | 7/20 [00:00<00:01,  8.81it/s, eval_psnr=21, total_loss=0.00199, train_psnr=27.7]    Epoch 10:  35%|███▌      | 7/20 [00:00<00:01,  8.81it/s, eval_psnr=21, total_loss=0.00204, train_psnr=27.6]    Epoch 10:  40%|████      | 8/20 [00:00<00:01,  8.82it/s, eval_psnr=21, total_loss=0.00204, train_psnr=27.6]    Epoch 10:  40%|████      | 8/20 [00:00<00:01,  8.82it/s, eval_psnr=21, total_loss=0.00204, train_psnr=27.6]    Epoch 10:  40%|████      | 8/20 [00:01<00:01,  8.82it/s, eval_psnr=21, total_loss=0.00205, train_psnr=27.5]    Epoch 10:  45%|████▌     | 9/20 [00:01<00:01,  8.84it/s, eval_psnr=21, total_loss=0.00205, train_psnr=27.5]    Epoch 10:  45%|████▌     | 9/20 [00:01<00:01,  8.84it/s, eval_psnr=21, total_loss=0.00205, train_psnr=27.5]    Epoch 10:  45%|████▌     | 9/20 [00:01<00:01,  8.84it/s, eval_psnr=21, total_loss=0.002, train_psnr=27.6]      Epoch 10:  50%|█████     | 10/20 [00:01<00:01,  8.84it/s, eval_psnr=21, total_loss=0.002, train_psnr=27.6]    Epoch 10:  50%|█████     | 10/20 [00:01<00:01,  8.84it/s, eval_psnr=21, total_loss=0.002, train_psnr=27.6]    Epoch 10:  50%|█████     | 10/20 [00:01<00:01,  8.84it/s, eval_psnr=21, total_loss=0.00198, train_psnr=27.7]    Epoch 10:  55%|█████▌    | 11/20 [00:01<00:01,  8.67it/s, eval_psnr=21, total_loss=0.00198, train_psnr=27.7]    Epoch 10:  55%|█████▌    | 11/20 [00:01<00:01,  8.67it/s, eval_psnr=21, total_loss=0.00198, train_psnr=27.7]    Epoch 10:  55%|█████▌    | 11/20 [00:01<00:01,  8.67it/s, eval_psnr=21, total_loss=0.00196, train_psnr=27.7]    Epoch 10:  60%|██████    | 12/20 [00:01<00:00,  8.75it/s, eval_psnr=21, total_loss=0.00196, train_psnr=27.7]    Epoch 10:  60%|██████    | 12/20 [00:01<00:00,  8.75it/s, eval_psnr=21, total_loss=0.00196, train_psnr=27.7]    Epoch 10:  60%|██████    | 12/20 [00:01<00:00,  8.75it/s, eval_psnr=21, total_loss=0.00195, train_psnr=27.7]    Epoch 10:  65%|██████▌   | 13/20 [00:01<00:00,  8.80it/s, eval_psnr=21, total_loss=0.00195, train_psnr=27.7]    Epoch 10:  65%|██████▌   | 13/20 [00:01<00:00,  8.80it/s, eval_psnr=21, total_loss=0.00195, train_psnr=27.7]    Epoch 10:  65%|██████▌   | 13/20 [00:01<00:00,  8.80it/s, eval_psnr=21, total_loss=0.00199, train_psnr=27.6]    Epoch 10:  70%|███████   | 14/20 [00:01<00:00,  8.83it/s, eval_psnr=21, total_loss=0.00199, train_psnr=27.6]    Epoch 10:  70%|███████   | 14/20 [00:01<00:00,  8.83it/s, eval_psnr=21, total_loss=0.00199, train_psnr=27.6]    Epoch 10:  70%|███████   | 14/20 [00:01<00:00,  8.83it/s, eval_psnr=21, total_loss=0.00195, train_psnr=27.6]    Epoch 10:  75%|███████▌  | 15/20 [00:01<00:00,  8.82it/s, eval_psnr=21, total_loss=0.00195, train_psnr=27.6]    Epoch 10:  75%|███████▌  | 15/20 [00:01<00:00,  8.82it/s, eval_psnr=21, total_loss=0.00195, train_psnr=27.6]    Epoch 10:  75%|███████▌  | 15/20 [00:01<00:00,  8.82it/s, eval_psnr=21, total_loss=0.00191, train_psnr=27.7]    Epoch 10:  80%|████████  | 16/20 [00:01<00:00,  8.82it/s, eval_psnr=21, total_loss=0.00191, train_psnr=27.7]    Epoch 10:  80%|████████  | 16/20 [00:01<00:00,  8.82it/s, eval_psnr=21, total_loss=0.00191, train_psnr=27.7]    Epoch 10:  80%|████████  | 16/20 [00:01<00:00,  8.82it/s, eval_psnr=21, total_loss=0.00189, train_psnr=27.7]    Epoch 10:  85%|████████▌ | 17/20 [00:01<00:00,  8.85it/s, eval_psnr=21, total_loss=0.00189, train_psnr=27.7]    Epoch 10:  85%|████████▌ | 17/20 [00:01<00:00,  8.85it/s, eval_psnr=21, total_loss=0.00189, train_psnr=27.7]    Epoch 10:  85%|████████▌ | 17/20 [00:02<00:00,  8.85it/s, eval_psnr=21, total_loss=0.00185, train_psnr=27.8]    Epoch 10:  90%|█████████ | 18/20 [00:02<00:00,  8.87it/s, eval_psnr=21, total_loss=0.00185, train_psnr=27.8]    Epoch 10:  90%|█████████ | 18/20 [00:02<00:00,  8.87it/s, eval_psnr=21, total_loss=0.00185, train_psnr=27.8]    Epoch 10:  90%|█████████ | 18/20 [00:02<00:00,  8.87it/s, eval_psnr=21, total_loss=0.00185, train_psnr=27.8]    Epoch 10:  95%|█████████▌| 19/20 [00:02<00:00,  8.88it/s, eval_psnr=21, total_loss=0.00185, train_psnr=27.8]    Epoch 10:  95%|█████████▌| 19/20 [00:02<00:00,  8.88it/s, eval_psnr=21, total_loss=0.00185, train_psnr=27.8]    Epoch 10:  95%|█████████▌| 19/20 [00:02<00:00,  8.88it/s, eval_psnr=21, total_loss=0.00182, train_psnr=27.9]    Epoch 10: 100%|██████████| 20/20 [00:02<00:00,  8.81it/s, eval_psnr=21, total_loss=0.00182, train_psnr=27.9]    Epoch 10: 100%|██████████| 20/20 [00:02<00:00,  8.80it/s, eval_psnr=21, total_loss=0.00182, train_psnr=27.9]

    BaseUnfold(
      (fixed_point): FixedPoint(
        (iterator): PDNetIteration(
          (f_step): fStepPDNet()
          (g_step): gStepPDNet()
        )
      )
      (init_params_algo): ParameterDict(
          (K): Object of type: list
          (K_adjoint): Object of type: list
          (beta): Object of type: list
          (g_param): Object of type: list
      )
      (params_algo): ParameterDict(
          (K): Object of type: list
          (K_adjoint): Object of type: list
          (beta): Object of type: list
          (g_param): Object of type: list
      )
      (prior): ModuleList(
        (0-2): 3 x PDNetPrior(
          (model): PDNet_PrimalBlock(
            (in_conv): Conv2d(6, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            (conv_list): ModuleList(
              (0): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
            (out_conv): Conv2d(32, 5, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            (nl_list): ModuleList(
              (0-1): 2 x PReLU(num_parameters=1)
            )
          )
        )
      )
      (data_fidelity): ModuleList(
        (0-2): 3 x PDNetDataFid(
          (model): PDNet_DualBlock(
            (in_conv): Conv2d(7, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            (conv_list): ModuleList(
              (0): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            )
            (out_conv): Conv2d(32, 5, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
            (nl_list): ModuleList(
              (0-1): 2 x PReLU(num_parameters=1)
            )
          )
        )
      )
    )



.. GENERATED FROM PYTHON SOURCE LINES 260-264

Test the network
--------------------------------------------



.. GENERATED FROM PYTHON SOURCE LINES 264-282

.. code-block:: Python


    method = "learned primal-dual"
    save_folder = RESULTS_DIR / method / operation
    plot_images = True  # plot images. Images are saved in save_folder.
    plot_metrics = True  # compute performance and convergence metrics along the algorithm, curved saved in RESULTS_DIR and shown in wandb.

    test(
        model=model,
        test_dataloader=test_dataloader,
        physics=physics,
        device=device,
        plot_images=plot_images,
        save_folder=save_folder,
        verbose=verbose,
        plot_metrics=plot_metrics,
        wandb_vis=wandb_vis,  # test visualization can be done in Weight&Bias
        online_measurements=True,
    )



.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/unfolded/images/sphx_glr_demo_learned_primal_dual_001.png
         :alt: Input, No learning, Recons., GT
         :srcset: /auto_examples/unfolded/images/sphx_glr_demo_learned_primal_dual_001.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/unfolded/images/sphx_glr_demo_learned_primal_dual_002.png
         :alt: PSNR, residual
         :srcset: /auto_examples/unfolded/images/sphx_glr_demo_learned_primal_dual_002.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Processing data of operator 1 out of 1
      0%|          | 0/1 [00:00<?, ?it/s]    100%|██████████| 1/1 [00:01<00:00,  1.22s/it]    100%|██████████| 1/1 [00:01<00:00,  1.22s/it]
    Test PSNR: No learning rec.: -15.80+-0.00 dB | Model: 20.93+-0.00 dB. 

    (20.932941436767578, 0.0, -15.803513526916504, 0.0)




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 24.370 seconds)


.. _sphx_glr_download_auto_examples_unfolded_demo_learned_primal_dual.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: demo_learned_primal_dual.ipynb <demo_learned_primal_dual.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: demo_learned_primal_dual.py <demo_learned_primal_dual.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
